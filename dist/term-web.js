/*!
 * term-web.js v1.1.8
 * Github: https://github.com/zhw2590582/term-web#readme
 * (c) 2017-2020 Harvey Zack
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Term=e()}(this,function(){"use strict";var s=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t};var Z=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var r=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t},o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var a=t(function(i){function n(t,e){return i.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}i.exports=n});var e=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)},i=t(function(e){function i(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=i=function(t){return typeof t}:e.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}e.exports=i});var h=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e},u=t(function(e){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}e.exports=i});!function(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}(".term-container{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;border-radius:5px;-webkit-box-shadow:rgba(0,0,0,.55) 0 20px 68px;box-shadow:0 20px 68px rgba(0,0,0,.55);scrollbar-color:#666 transparent!important;scrollbar-width:thin!important}.term-container ::-webkit-scrollbar{width:5px}.term-container ::-webkit-scrollbar-thumb{background-color:#666;border-radius:5px}.term-container ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.term-container.is-dragging{opacity:.95}.term-container.is-fullscreen{position:fixed!important;z-index:9999!important;top:0!important;left:0!important;bottom:0!important;right:0!important;width:100%!important;height:100%!important}.term-container .term-canvas{position:absolute;z-index:1;top:0;left:0;bottom:0;right:0;width:100%;height:100%}.term-container .term-textarea{z-index:2}.term-container .term-copy,.term-container .term-textarea{position:absolute;width:20px;height:20px;opacity:0;pointer-events:none;resize:none}.term-container .term-copy{z-index:3}.term-container .term-header{position:absolute;z-index:4;width:100%;top:0;left:0;right:0}.term-container .term-header .term-recorder{position:absolute;right:10px;top:10px;height:18px;width:18px;border-radius:3px;cursor:pointer;border-style:solid;border-width:0;background:#f44336;-webkit-transition:all .2s ease;transition:all .2s ease}@-webkit-keyframes loop{0%{border-width:1px}50%{border-width:6px}to{border-width:1px}}@keyframes loop{0%{border-width:1px}50%{border-width:6px}to{border-width:1px}}.term-container .term-header .term-recorder.recording{background:#ff5722}.term-container .term-header .term-recorder.creating,.term-container .term-header .term-recorder.recording{border-color:rgba(255,254,254,.5);border-radius:50%;-webkit-animation:loop 1s linear infinite;animation:loop 1s linear infinite}.term-container .term-header .term-recorder.creating{background:#009688}.term-container .term-content{position:absolute;z-index:5;width:100%;right:0;left:0;overflow:auto}.term-container .term-content:hover{cursor:text}.term-container .term-footer{position:absolute;z-index:6;width:100%;bottom:0;left:0;right:0}.term-container .term-footer .term-resize{position:absolute;right:0;bottom:0;width:20px;height:20px;cursor:nwse-resize}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsZ0JBQ0UsaUJBQWtCLENBQ2xCLHdCQUFpQixDQUFqQixxQkFBaUIsQ0FBakIsb0JBQWlCLENBQWpCLGdCQUFpQixDQUNqQixlQUFnQixDQUNoQixpQkFBa0IsQ0FDbEIsOENBQTZDLENBQTdDLHNDQUE2QyxDQUM3QywwQ0FBNEMsQ0FDNUMsOEJBQWtDLENBQ2xDLG9DQUNFLFNBQVksQ0FDZCwwQ0FDRSxxQkFBc0IsQ0FDdEIsaUJBQW9CLENBQ3RCLGdEQUNFLHFCQUF3QixDQUMxQiw0QkFDRSxXQUFlLENBQ2pCLDhCQUNFLHdCQUEwQixDQUMxQixzQkFBd0IsQ0FDeEIsZUFBaUIsQ0FDakIsZ0JBQWtCLENBQ2xCLGtCQUFvQixDQUNwQixpQkFBbUIsQ0FDbkIsb0JBQXNCLENBQ3RCLHFCQUF5QixDQUMzQiw2QkFDRSxpQkFBa0IsQ0FDbEIsU0FBVSxDQUNWLEtBQU0sQ0FDTixNQUFPLENBQ1AsUUFBUyxDQUNULE9BQVEsQ0FDUixVQUFXLENBQ1gsV0FBYyxDQUNoQiwrQkFFRSxTQUtjLENBQ2hCLDBEQVBFLGlCQUFrQixDQUVsQixVQUFXLENBQ1gsV0FBWSxDQUNaLFNBQVUsQ0FDVixtQkFBb0IsQ0FDcEIsV0FRYyxDQVBoQiwyQkFFRSxTQUtjLENBQ2hCLDZCQUNFLGlCQUFrQixDQUNsQixTQUFVLENBQ1YsVUFBVyxDQUNYLEtBQU0sQ0FDTixNQUFPLENBQ1AsT0FBVSxDQUNWLDRDQUNFLGlCQUFrQixDQUNsQixVQUFXLENBQ1gsUUFBUyxDQUNULFdBQVksQ0FDWixVQUFXLENBQ1gsaUJBQWtCLENBQ2xCLGNBQWUsQ0FDZixrQkFBbUIsQ0FDbkIsY0FBZSxDQUNmLGtCQUFtQixDQUNuQiwrQkFBeUIsQ0FBekIsdUJBQTJCLENBRWpDLHdCQUNFLEdBQ0UsZ0JBQW1CLENBQ3JCLElBQ0UsZ0JBQW1CLENBQ3JCLEdBQ0UsZ0JBQW1CLENBQUUsQ0FOekIsZ0JBQ0UsR0FDRSxnQkFBbUIsQ0FDckIsSUFDRSxnQkFBbUIsQ0FDckIsR0FDRSxnQkFBbUIsQ0FBRSxDQUNuQixzREFDRSxrQkFHb0MsQ0FDdEMsMkdBSEUsaUNBQXNDLENBQ3RDLGlCQUFrQixDQUNsQix5Q0FBa0MsQ0FBbEMsaUNBS29DLENBSnRDLHFEQUNFLGtCQUdvQyxDQUMxQyw4QkFDRSxpQkFBa0IsQ0FDbEIsU0FBVSxDQUNWLFVBQVcsQ0FDWCxPQUFRLENBQ1IsTUFBTyxDQUNQLGFBQWdCLENBQ2hCLG9DQUNFLFdBQWMsQ0FDbEIsNkJBQ0UsaUJBQWtCLENBQ2xCLFNBQVUsQ0FDVixVQUFXLENBQ1gsUUFBUyxDQUNULE1BQU8sQ0FDUCxPQUFVLENBQ1YsMENBQ0UsaUJBQWtCLENBQ2xCLE9BQVEsQ0FDUixRQUFTLENBQ1QsVUFBVyxDQUNYLFdBQVksQ0FDWixrQkFBcUIiLCJmaWxlIjoiaW5kZXguc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi50ZXJtLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgYm94LXNoYWRvdzogcmdiYSgwLCAwLCAwLCAwLjU1KSAwcHggMjBweCA2OHB4O1xuICBzY3JvbGxiYXItY29sb3I6ICM2NjYgdHJhbnNwYXJlbnQgIWltcG9ydGFudDtcbiAgc2Nyb2xsYmFyLXdpZHRoOiB0aGluICFpbXBvcnRhbnQ7IH1cbiAgLnRlcm0tY29udGFpbmVyIDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICAgIHdpZHRoOiA1cHg7IH1cbiAgLnRlcm0tY29udGFpbmVyIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICM2NjY7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4OyB9XG4gIC50ZXJtLWNvbnRhaW5lciA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjY2NjOyB9XG4gIC50ZXJtLWNvbnRhaW5lci5pcy1kcmFnZ2luZyB7XG4gICAgb3BhY2l0eTogMC45NTsgfVxuICAudGVybS1jb250YWluZXIuaXMtZnVsbHNjcmVlbiB7XG4gICAgcG9zaXRpb246IGZpeGVkICFpbXBvcnRhbnQ7XG4gICAgei1pbmRleDogOTk5OSAhaW1wb3J0YW50O1xuICAgIHRvcDogMCAhaW1wb3J0YW50O1xuICAgIGxlZnQ6IDAgIWltcG9ydGFudDtcbiAgICBib3R0b206IDAgIWltcG9ydGFudDtcbiAgICByaWdodDogMCAhaW1wb3J0YW50O1xuICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7XG4gICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7IH1cbiAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWNhbnZhcyB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDE7XG4gICAgdG9wOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgYm90dG9tOiAwO1xuICAgIHJpZ2h0OiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTsgfVxuICAudGVybS1jb250YWluZXIgLnRlcm0tdGV4dGFyZWEge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB6LWluZGV4OiAyO1xuICAgIHdpZHRoOiAyMHB4O1xuICAgIGhlaWdodDogMjBweDtcbiAgICBvcGFjaXR5OiAwO1xuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgIHJlc2l6ZTogbm9uZTsgfVxuICAudGVybS1jb250YWluZXIgLnRlcm0tY29weSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDM7XG4gICAgd2lkdGg6IDIwcHg7XG4gICAgaGVpZ2h0OiAyMHB4O1xuICAgIG9wYWNpdHk6IDA7XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgcmVzaXplOiBub25lOyB9XG4gIC50ZXJtLWNvbnRhaW5lciAudGVybS1oZWFkZXIge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB6LWluZGV4OiA0O1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHRvcDogMDtcbiAgICBsZWZ0OiAwO1xuICAgIHJpZ2h0OiAwOyB9XG4gICAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWhlYWRlciAudGVybS1yZWNvcmRlciB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICByaWdodDogMTBweDtcbiAgICAgIHRvcDogMTBweDtcbiAgICAgIGhlaWdodDogMThweDtcbiAgICAgIHdpZHRoOiAxOHB4O1xuICAgICAgYm9yZGVyLXJhZGl1czogM3B4O1xuICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDtcbiAgICAgIGJvcmRlci13aWR0aDogMDtcbiAgICAgIGJhY2tncm91bmQ6ICNmNDQzMzY7XG4gICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlOyB9XG5cbkBrZXlmcmFtZXMgbG9vcCB7XG4gIDAlIHtcbiAgICBib3JkZXItd2lkdGg6IDFweDsgfVxuICA1MCUge1xuICAgIGJvcmRlci13aWR0aDogNnB4OyB9XG4gIDEwMCUge1xuICAgIGJvcmRlci13aWR0aDogMXB4OyB9IH1cbiAgICAgIC50ZXJtLWNvbnRhaW5lciAudGVybS1oZWFkZXIgLnRlcm0tcmVjb3JkZXIucmVjb3JkaW5nIHtcbiAgICAgICAgYmFja2dyb3VuZDogI2ZmNTcyMjtcbiAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU0LCAyNTQsIDAuNSk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgYW5pbWF0aW9uOiBsb29wIDFzIGxpbmVhciBpbmZpbml0ZTsgfVxuICAgICAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWhlYWRlciAudGVybS1yZWNvcmRlci5jcmVhdGluZyB7XG4gICAgICAgIGJhY2tncm91bmQ6ICMwMDk2ODg7XG4gICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSgyNTUsIDI1NCwgMjU0LCAwLjUpO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7XG4gICAgICAgIGFuaW1hdGlvbjogbG9vcCAxcyBsaW5lYXIgaW5maW5pdGU7IH1cbiAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWNvbnRlbnQge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB6LWluZGV4OiA1O1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHJpZ2h0OiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgb3ZlcmZsb3c6IGF1dG87IH1cbiAgICAudGVybS1jb250YWluZXIgLnRlcm0tY29udGVudDpob3ZlciB7XG4gICAgICBjdXJzb3I6IHRleHQ7IH1cbiAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWZvb3RlciB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDY7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgYm90dG9tOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgcmlnaHQ6IDA7IH1cbiAgICAudGVybS1jb250YWluZXIgLnRlcm0tZm9vdGVyIC50ZXJtLXJlc2l6ZSB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICByaWdodDogMDtcbiAgICAgIGJvdHRvbTogMDtcbiAgICAgIHdpZHRoOiAyMHB4O1xuICAgICAgaGVpZ2h0OiAyMHB4O1xuICAgICAgY3Vyc29yOiBud3NlLXJlc2l6ZTsgfVxuIl19 */");var f=t(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return t.constructor?t.constructor.name:null}function a(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:["option"];return h(t,e,i),u(t,e,i),function(o,s,c){var t=l(s),e=l(o);if("object"===t){if("object"!==e)throw new Error("[Type Error]: '".concat(c.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(s).forEach(function(t){var e=o[t],i=s[t],n=c.slice();n.push(t),h(e,i,n),u(e,i,n),a(e,i,n)})}if("array"===t){if("array"!==e)throw new Error("[Type Error]: '".concat(c.join("."),"' require 'array' type, but got '").concat(e,"'"));o.forEach(function(t,e){var i=o[e],n=s[e]||s[0],r=c.slice();r.push(e),h(i,n,r),u(i,n,r),a(i,n,r)})}}(t,e,i),t}function h(t,e,i){if("string"===l(e)){var n=l(t);if(!(-1<e.indexOf("|")?e.split("|").map(function(t){return t.toLowerCase().trim()}).filter(Boolean).some(function(t){return n===t}):e.toLowerCase().trim()===n))throw new Error("[Type Error]: '".concat(i.join("."),"' require '").concat(e,"' type, but got '").concat(n,"'"))}}function u(t,e,i){if("function"===l(e)){var n=e(t,l(t),i);if(!0!==n){var r=l(n);throw"string"===r?new Error(n):"error"===r?n:new Error("[Validator Error]: The scheme for '".concat(i.join("."),"' validator require return true, but got '").concat(n,"'"))}}}var o,l;t.exports=(o=Object.prototype.toString,a.kindOf=l=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e,i=n(t);if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return"GeneratorFunction"===r(t)?"generatorfunction":"function";if(e=t,Array.isArray?Array.isArray(e):e instanceof Array)return"array";if(t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return 1}catch(t){if(-1!==t.message.indexOf("callee"))return 1}}(t))return"arguments";if(t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate)return"date";if(t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit)return"error";if(t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global)return"regexp";switch(r(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next)return"generator";switch(i=o.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")},a)}),l=function(){function t(){Z(this,t)}return c(t,[{key:"on",value:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this}},{key:"once",value:function(n,r,o){var s=this;function c(){s.off(n,c);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];r.apply(o,e)}return c._=r,this.on(n,c,o)}},{key:"emit",value:function(t){for(var e=((this.e||(this.e={}))[t]||[]).slice(),i=arguments.length,n=new Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var o=0;o<e.length;o+=1)e[o].fn.apply(e[o].ctx,n);return this}},{key:"off",value:function(t,e){var i=this.e||(this.e={}),n=i[t],r=[];if(n&&e)for(var o=0,s=n.length;o<s;o+=1)n[o].fn!==e&&n[o].fn._!==e&&r.push(n[o]);return r.length?i[t]=r:delete i[t],this}}]),t}();var d=t(function(t){var e,i;e=window,i=function(){function y(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var i="undefined"==typeof console?function(){}:function(t){console.error(t)},b=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],v=b.length;function x(t){var e=getComputedStyle(t);return e||i("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var I,w=!1;function k(t){if(!function(){if(!w){w=!0;var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style.boxSizing="border-box";var e=document.body||document.documentElement;e.appendChild(t);var i=x(t);I=200==Math.round(y(i.width)),k.isBoxSizeOuter=I,e.removeChild(t)}}(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var e=x(t);if("none"==e.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<v;e++){t[b[e]]=0}return t}();var i={};i.width=t.offsetWidth,i.height=t.offsetHeight;for(var n=i.isBorderBox="border-box"==e.boxSizing,r=0;r<v;r++){var o=b[r],s=e[o],c=parseFloat(s);i[o]=isNaN(c)?0:c}var a=i.paddingLeft+i.paddingRight,h=i.paddingTop+i.paddingBottom,u=i.marginLeft+i.marginRight,l=i.marginTop+i.marginBottom,d=i.borderLeftWidth+i.borderRightWidth,f=i.borderTopWidth+i.borderBottomWidth,p=n&&I,g=y(e.width);!1!==g&&(i.width=g+(p?0:a+d));var m=y(e.height);return!1!==m&&(i.height=m+(p?0:h+f)),i.innerWidth=i.width-(a+d),i.innerHeight=i.height-(h+f),i.outerWidth=i.width+u,i.outerHeight=i.height+l,i}}return k},t.exports?t.exports=i():e.getSize=i()}),p=t(function(t){var e,i;e="undefined"!=typeof window?window:o,i=function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r];n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t},t.exports?t.exports=i():e.EvEmitter=i()}),g=t(function(t){var e,i;e=window,i=function(r,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindStartEvent=function(t){this._bindStartEvent(t,!0)},i.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},i._bindStartEvent=function(t,e){var i=(e=void 0===e||e)?"addEventListener":"removeEventListener",n="mousedown";r.PointerEvent?n="pointerdown":"ontouchstart"in r&&(n="touchstart"),t[i](n,this)},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},i.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},i.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},i.onpointerdown=function(t){this._pointerDown(t,t)},i._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},i.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var n={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return i._bindPostStartEvents=function(t){if(t){var e=n[t.type];e.forEach(function(t){r.addEventListener(t,this)},this),this._boundPointerEvents=e}},i._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(t){r.removeEventListener(t,this)},this),delete this._boundPointerEvents)},i.onmousemove=function(t){this._pointerMove(t,t)},i.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},i.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},i._pointerMove=function(t,e){this.pointerMove(t,e)},i.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},i.onmouseup=function(t){this._pointerUp(t,t)},i.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},i.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},i._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},i._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},i._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},i.pointerDone=function(){},i.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},i.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},i._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},i.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},e.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},e},t.exports?t.exports=i(e,p):e.Unipointer=i(e,e.EvEmitter)}),m=t(function(t){var e,i;e=window,i=function(o,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindHandles=function(){this._bindHandles(!0)},i.unbindHandles=function(){this._bindHandles(!1)},i._bindHandles=function(t){for(var e=(t=void 0===t||t)?"addEventListener":"removeEventListener",i=t?this._touchActionValue:"",n=0;n<this.handles.length;n++){var r=this.handles[n];this._bindStartEvent(r,t),r[e]("click",this),o.PointerEvent&&(r.style.touchAction=i)}},i._touchActionValue="none",i.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var r={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return i.okayPointerDown=function(t){var e=r[t.target.nodeName],i=s[t.target.type],n=!e||i;return n||this._pointerReset(),n},i.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},i.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},i._dragPointerMove=function(t,e){var i={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(t,e),i},i.hasDragStarted=function(t){return 3<Math.abs(t.x)||3<Math.abs(t.y)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},i._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},i._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},i.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},i._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},i.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},i._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},i.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},i.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},i._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},i.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},e.getPointerPoint=t.getPointerPoint,e},t.exports?t.exports=i(e,g):e.Unidragger=i(e,e.Unipointer)}),y=t(function(t){var e,i;e=window,i=function(o,a,t){function i(t,e){for(var i in e)t[i]=e[i];return t}var n=o.jQuery;function e(t,e){this.element="string"==typeof t?document.querySelector(t):t,n&&(this.$element=n(this.element)),this.options=i({},this.constructor.defaults),this.option(e),this._create()}var r=e.prototype=Object.create(t.prototype);e.defaults={},r.option=function(t){i(this.options,t)};var s={relative:!0,absolute:!0,fixed:!0};function h(t,e,i){return i=i||"round",e?Math[i](t/e)*e:t}return r._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=i({},this.position);var t=getComputedStyle(this.element);s[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},r.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},r.dispatchEvent=function(t,e,i){var n=[e].concat(i);this.emitEvent(t,n),this.dispatchJQueryEvent(t,e,i)},r.dispatchJQueryEvent=function(t,e,i){var n=o.jQuery;if(n&&this.$element){var r=n.Event(e);r.type=t,this.$element.trigger(r,i)}},r._getPosition=function(){var t=getComputedStyle(this.element),e=this._getPositionCoord(t.left,"width"),i=this._getPositionCoord(t.top,"height");this.position.x=isNaN(e)?0:e,this.position.y=isNaN(i)?0:i,this._addTransformPosition(t)},r._getPositionCoord=function(t,e){if(-1==t.indexOf("%"))return parseInt(t,10);var i=a(this.element.parentNode);return i?parseFloat(t)/100*i[e]:0},r._addTransformPosition=function(t){var e=t.transform;if(0===e.indexOf("matrix")){var i=e.split(","),n=0===e.indexOf("matrix3d")?12:4,r=parseInt(i[n],10),o=parseInt(i[1+n],10);this.position.x+=r,this.position.y+=o}},r.onPointerDown=function(t,e){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[e])},r.dragStart=function(t,e){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[e]),this.animate())},r.measureContainment=function(){var t=this.getContainer();if(t){var e=a(this.element),i=a(t),n=this.element.getBoundingClientRect(),r=t.getBoundingClientRect(),o=i.borderLeftWidth+i.borderRightWidth,s=i.borderTopWidth+i.borderBottomWidth,c=this.relativeStartPosition={x:n.left-(r.left+i.borderLeftWidth),y:n.top-(r.top+i.borderTopWidth)};this.containSize={width:i.width-o-c.x-e.width,height:i.height-s-c.y-e.height}}},r.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},r.onPointerMove=function(t,e,i){this.dispatchJQueryEvent("pointerMove",t,[e,i])},r.dragMove=function(t,e,i){if(this.isEnabled){var n=i.x,r=i.y,o=this.options.grid,s=o&&o[0],c=o&&o[1];n=h(n,s),r=h(r,c),n=this.containDrag("x",n,s),r=this.containDrag("y",r,c),n="y"==this.options.axis?0:n,r="x"==this.options.axis?0:r,this.position.x=this.startPosition.x+n,this.position.y=this.startPosition.y+r,this.dragPoint.x=n,this.dragPoint.y=r,this.dispatchEvent("dragMove",t,[e,i])}},r.containDrag=function(t,e,i){if(!this.options.containment)return e;var n="x"==t?"width":"height",r=h(-this.relativeStartPosition[t],i,"ceil"),o=this.containSize[n];return o=h(o,i,"floor"),Math.max(r,Math.min(o,e))},r.onPointerUp=function(t,e){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[e])},r.dragEnd=function(t,e){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[e]))},r.animate=function(){if(this.isDragging){this.positionDrag();var t=this;requestAnimationFrame(function(){t.animate()})}},r.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},r.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},r.staticClick=function(t,e){this.dispatchEvent("staticClick",t,[e])},r.setPosition=function(t,e){this.position.x=t,this.position.y=e,this.setLeftTop()},r.enable=function(){this.isEnabled=!0},r.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},r.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},r._init=function(){},n&&n.bridget&&n.bridget("draggabilly",e),e},t.exports?t.exports=i(e,d,m):e.Draggabilly=i(e,e.getSize,e.Unidragger)});function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function M(t,e){var i=t.options,n=i.dragOpt,r=i.draggable,o=t.template.$container;r&&(e.draggie=new y(o,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({handle:".term-header"},n)),t.on("destroy",function(){e.draggie.destroy()}))}var v=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")};var x=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}},I=t(function(n){function r(t,e,i){return x()?n.exports=r=Reflect.construct:n.exports=r=function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&a(r,i.prototype),r},r.apply(null,arguments)}n.exports=r});function w(n){return function(){var t,e=u(n);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=u(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return h(this,t)}}var k=function(t){e(n,t);var i=w(n);function n(t){var e;return Z(this,n),(e=i.call(this,t)).name="TermError",e}return n}(t(function(e){function n(t){var i="function"==typeof Map?new Map:void 0;return e.exports=n=function(t){if(null===t||!v(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,e)}function e(){return I(t,arguments,u(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a(e,t)},n(t)}e.exports=n})(Error));function C(t,e){if(!t)throw new k(e);return t}function Q(t,e){var i=document.createElement("a");i.style.display="none",i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function _(n,r,o){var s;return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];clearTimeout(s),s=setTimeout(function(){s=null,n.apply(o,e)},r)}}function A(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}function E(t){return t.replace(/[&<>'"]/g,function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[t]||t})}var L=Object.freeze({__proto__:null,TermError:k,errorHandle:C,clamp:function(t,e,i){return Math.max(Math.min(t,Math.max(e,i)),Math.min(e,i))},download:Q,debounce:_,uuid:A,escape:E,unescape:function(t){return t.replace(/&amp;|&lt;|&gt;|&#39;|&quot;/g,function(t){return{"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'}[t]||t})}});var D="input",B="output",O="radio",F="checkbox",R={videoBitsPerSecond:5e6,mimeType:"video/webm"};function $(o){var s=o.template.$textarea,c=0;o.on("enter",function(){c=0}),o.on("render",function(){o.drawer&&!o.drawer.renderEditable&&(c=0)}),o.on("history",function(t){var e,i,n,r;e=t,i=o.drawer.cacheEmits,n=i.filter(function(t,e){return t.type===D&&t.text.trim()&&e!==i.length-1}),(r=n[n.length+c+e])&&(c+=e,s.value=r.text,o.drawer.emit({type:D,text:r.text,replace:!0}))})}var U=function(){function H(t){var e,i,n,r,o,s,c,a,h,u,l,d,f,p,g,m,y,b,v,x,I,w,k,C,Q,L,A,E,D,B,O,F,R,U,S,G,W,N,P,T,X,j;Z(this,H),this.term=t,this.destroyEvents=[],this.proxy=this.proxy.bind(this),i=this,n=(e=t).template.$textarea,i.proxy(document,["click","contextmenu","dblclick"],function(t){t.composedPath&&-1<t.composedPath().indexOf(e.template.$content)?(e.isFocus=!0,e.emit("focus"),e.emit(t.type,t)):e.isFocus&&(e.isFocus=!1,e.emit("blur"))}),e.on("focus",function(){n.focus()}),e.on("click",function(t){var e=i.getLogFromEvent(t).log;e&&e.href&&window.open(e.href)}),e.options.autofocus&&setTimeout(function(){e.template.$content.click()},10),o=this,s=(r=t).template,c=s.$container,a=s.$content,h=s.$resize,u=s.$canvas,l=s.$header,d=s.$footer,f=r.options.pixelRatio,p=!1,b=y=m=g=0,o.proxy(h,"mousedown",function(t){p=!0;var e=c.clientWidth,i=c.clientHeight;y=e,b=i,g=t.pageX,m=t.pageY}),o.proxy(document,"mousemove",function(t){if(p){a.style.visibility="hidden";var e=y+t.pageX-g,i=b+t.pageY-m;300<=e&&300<=i&&(c.style.width="".concat(e,"px"),c.style.height="".concat(i,"px"))}}),o.proxy(document,"mouseup",function(){if(p){p=!1,b=y=m=g=0,a.style.visibility="visible";var t=c.clientWidth,e=c.clientHeight;r.emit("resize",{width:t,height:e})}}),r.on("resize",function(t){var e=t.width,i=t.height;c.style.width="".concat(e,"px"),c.style.height="".concat(i,"px"),u.width=e*f,u.height=i*f,r.drawer.init()}),r.on("size",function(t){var e=t.header,i=t.content,n=t.footer;l.style.height="".concat(e,"px"),d.style.height="".concat(n,"px"),a.style.top="".concat(e,"px"),a.style.height="".concat(i,"px")}),M(t,this),x=this,I=(v=t).template.$textarea,x.proxy(I,"input",function(){v.emit("input",I.value.trim())}),x.proxy(I,"paste",function(){v.emit("input",I.value.trim())}),v.on("cursor",function(t){var e=t.left,i=t.top;I.style.top="".concat(i,"px"),I.style.left="".concat(e,"px")}),function(t,e){if(t.options.recorder){var i=t.template.$recorder;e.proxy(i,"click",function(){t.recorder.recording?t.recorder.end():t.recorder.start()}),t.on("start",function(){i.classList.remove("creating"),i.classList.add("recording")}),t.on("creating",function(){i.classList.remove("recording"),i.classList.add("creating")}),t.on("end",function(){i.classList.remove("recording"),i.classList.remove("creating")})}}(t,this),k=this,C=(w=t).template,Q=C.$content,L=C.$scrollbar,A=!1,k.proxy(Q,"scroll",function(){A?w.drawer.renderByTop(Q.scrollTop):A=!0}),w.on("scrollTop",function(t){A?A=!1:Q.scrollTop=t}),w.on("scrollHeight",function(t){L.style.height="".concat(t,"px")}),D=this,B=(E=t).template.$copy,O=[],F=0,E.on("click",function(){if(E.drawer.render(!1),F&&O.length&&Date.now()-F<=300){var t=E.drawer,e=t.fontSize,i=t.ctx,n=t.contentWidth,r=t.contentPadding,o=E.options,s=o.background,c=o.color,a=O.reduce(function(t,e){return t+e.text},"");i.fillStyle=c,i.fillRect(r[3],O[0].top,n,e),i.fillStyle=s,i.fillText(a,r[3],O[0].top),B.value=a,B.focus(),B.select()}else O=[],F=0,B.value=""}),E.on("dblclick",function(t){E.drawer.render(!1);var e=D.getLogFromEvent(t),i=e.line,n=e.log;if(O=[],F=0,B.value="",n){var r=E.drawer,o=r.ctx,s=r.fontSize,c=E.options,a=c.background,h=c.color;O=i,F=Date.now(),o.fillStyle=h,o.fillRect(n.left,n.top,n.width,s),o.fillStyle=a,o.fillText(n.text,n.left,n.top),B.value=n.text,B.focus(),B.select()}}),E.on("blur",function(){E.drawer.render(!1),O=[],F=0,B.value=""}),U=this,S=(R=t).template,G=S.$container,W=S.$header,N=!1,P=_(function(){var t=document.body.getBoundingClientRect(),e=t.width,i=t.height;R.emit("resize",{width:e,height:i})},100),R.on("fullscreen",function(t){(N=t)?(P(),G.classList.add("is-fullscreen"),U.draggie&&U.draggie.disable()):(G.classList.remove("is-fullscreen"),R.emit("resize",{width:R.options.width,height:R.options.height}),U.draggie&&U.draggie.enable())}),U.proxy(W,"dblclick",function(t){t.target===W&&R.emit("fullscreen",!N)}),U.proxy(window,"resize",function(){N&&P()}),$(t),X=this,j=(T=t).template.$textarea,X.proxy(j,"keydown",function(t){T.emit("keydown",t);var e=t.keyCode;13===e&&(T.emit("enter",j.value.trim()),j.value=""),t.ctrlKey&&67===e&&(j.value="",T.input(),T.emit("abort")),[37,38,39,40].includes(e)&&t.preventDefault(),T.drawer.renderEditable&&(38===e&&T.emit("history",-1),40===e&&T.emit("history",1))})}return c(H,[{key:"getLogFromEvent",value:function(t){var e=this.term.template.$content,i=this.term.options.pixelRatio,n=e.getBoundingClientRect(),r=(t.pageX-n.left)*i,o=(t.pageY-n.top)*i,s=this.term.drawer,c=s.renderLines,a=s.lineHeight,h=c[Math.floor(o/a)]||[],u=h.find(function(t){return r>t.left&&t.left+t.width>=r});return{line:h,log:u}}},{key:"proxy",value:function(e,t,i,n){var r=this,o=3<arguments.length&&void 0!==n?n:{};Array.isArray(t)?t.forEach(function(t){return r.proxy(e,t,i,o)}):(e.addEventListener(t,i,o),this.destroyEvents.push(function(){e.removeEventListener(t,i,o)}))}},{key:"destroy",value:function(){this.destroyEvents.forEach(function(t){return t()})}}]),H}(),S=function(){function a(t){var e=this;Z(this,a);var i=(this.term=t).options,n=i.container,r=i.pixelRatio,o=i.width,s=i.height,c=i.recorder;this.$container=n,"string"==typeof t.options.container&&(this.$container=document.querySelector(t.options.container)),C(t.constructor.instances.every(function(t){return t.template.$container!==e.$container}),"Cannot mount multiple instances on the same dom element, please destroy the previous instance first."),this.$container.classList.add("term-container"),this.$container.style.width="".concat(o,"px"),this.$container.style.height="".concat(s,"px"),this.$canvas=document.createElement("canvas"),this.$canvas.classList.add("term-canvas"),this.$canvas.width=o*r,this.$canvas.height=s*r,this.$container.appendChild(this.$canvas),this.$textarea=document.createElement("textarea"),this.$textarea.classList.add("term-textarea"),this.$container.appendChild(this.$textarea),this.$copy=document.createElement("textarea"),this.$copy.classList.add("term-copy"),this.$container.appendChild(this.$copy),this.$header=document.createElement("div"),this.$header.classList.add("term-header"),this.$container.appendChild(this.$header),this.$content=document.createElement("div"),this.$content.classList.add("term-content"),this.$container.appendChild(this.$content),this.$scrollbar=document.createElement("div"),this.$scrollbar.classList.add("term-scrollbar"),this.$scrollbar.style.height="0",this.$content.appendChild(this.$scrollbar),this.$footer=document.createElement("div"),this.$footer.classList.add("term-footer"),this.$container.appendChild(this.$footer),this.$resize=document.createElement("div"),this.$resize.classList.add("term-resize"),this.$footer.appendChild(this.$resize),c&&(this.$recorder=document.createElement("div"),this.$recorder.classList.add("term-recorder"),this.$header.appendChild(this.$recorder))}return c(a,[{key:"destroy",value:function(){this.$container.classList.remove("term-container"),this.$container.innerHTML=""}}]),a}();var G=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n};var W=function(t){if(Array.isArray(t))return G(t)};var N=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)};var P=function(t,e){if(t){if("string"==typeof t)return G(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?G(t,e):void 0}};var T=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var X=function(t){return W(t)||N(t)||P(t)||T()},j=t(function(t,e){t.exports=function(){var t=document.createElement("canvas");t.style.position="fixed",t.style.left="-999px",t.style.top="-999px",t.width=100,t.height=100,document.body.appendChild(t);var e=t.getContext("2d");e.textBaseline="top",e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,100,100),e.fillStyle="rgb(255, 255, 255)",e.fillText("T",0,10);for(var o={},i=1;i<=100;i++){e.fillStyle="rgb(0, 0, 0)";e.fillRect(0,0,100,100);e.fillStyle="rgb(255, 255, 255)";e.font=i+"px Arial";e.fillText("T",0,10);var n=5*i/10;for(var r=0;r<20;r++){var s=e.getImageData(n,r,1,1).data;if(s[0]!==0&&s[1]!==0&&s[2]!==0){o[i]=r-10;break}}}return document.body.removeChild(t),function(n){if("object"!=typeof n)return n;var r=Object.getPrototypeOf(n).fillText;return"function"!=typeof r||(n.fillText=function(){var t=arguments[2];if("number"==typeof t){var e=n.font.match(/(\d+)(?:\.\d?)?px/i);if(e&&e[1]){var i=o[e[1]];i&&(arguments[2]=t-i)}}return r.apply(this,arguments)}),n}}()});function H(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function V(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?H(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function z(t,e){var s={bools:{},strings:{},unknownFn:null};"function"==typeof(e=e||{}).unknown&&(s.unknownFn=e.unknown),"boolean"==typeof e.boolean&&e.boolean?s.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(t){s.bools[t]=!0});var c={};Object.keys(e.alias||{}).forEach(function(t){c[t]=[].concat(e.alias[t]),c[t].forEach(function(e){c[e]=[t].concat(c[t].filter(function(t){return e!==t}))})}),[].concat(e.string).filter(Boolean).forEach(function(t){s.strings[t]=!0,c[t]&&(s.strings[c[t]]=!0)});var r=e.default||{},a={_:[]};Object.keys(s.bools).forEach(function(t){n(t,void 0!==r[t]&&r[t])});var i=[];function n(t,e,i){if(!i||!s.unknownFn||(n=t,r=i,s.allBools&&/^--[^=]+$/.test(r)||s.strings[n]||s.bools[n]||c[n])||!1!==s.unknownFn(i)){var n,r,o=!s.strings[t]&&J(e)?Number(e):e;h(a,t.split("."),o),(c[t]||[]).forEach(function(t){h(a,t.split("."),o)})}}function h(t,e,i){for(var n=t,r=0;r<e.length-1;r++){if("__proto__"===(o=e[r]))return;void 0===n[o]&&(n[o]={}),n[o]!==Object.prototype&&n[o]!==Number.prototype&&n[o]!==String.prototype||(n[o]={}),n[o]===Array.prototype&&(n[o]=[]),n=n[o]}var o;"__proto__"!==(o=e[e.length-1])&&(n!==Object.prototype&&n!==Number.prototype&&n!==String.prototype||(n={}),n===Array.prototype&&(n=[]),void 0===n[o]||s.bools[o]||"boolean"==typeof n[o]?n[o]=i:Array.isArray(n[o])?n[o].push(i):n[o]=[n[o],i])}function o(t){return c[t].some(function(t){return s.bools[t]})}-1!==t.indexOf("--")&&(i=t.slice(t.indexOf("--")+1),t=t.slice(0,t.indexOf("--")));for(var u=0;u<t.length;u++){var l=t[u];if(/^--.+=/.test(l)){var d=l.match(/^--([^=]+)=([\s\S]*)$/),f=d[1],p=d[2];s.bools[f]&&(p="false"!==p),n(f,p,l)}else if(/^--no-.+/.test(l)){n(f=l.match(/^--no-(.+)/)[1],!1,l)}else if(/^--.+/.test(l)){f=l.match(/^--(.+)/)[1];void 0===(b=t[u+1])||/^-/.test(b)||s.bools[f]||s.allBools||c[f]&&o(f)?/^(true|false)$/.test(b)?(n(f,"true"===b,l),u++):n(f,!s.strings[f]||"",l):(n(f,b,l),u++)}else if(/^-[^-]+/.test(l)){for(var g=l.slice(1,-1).split(""),m=!1,y=0;y<g.length;y++){var b;if("-"!==(b=l.slice(y+2))){if(/[A-Za-z]/.test(g[y])&&/=/.test(b)){n(g[y],b.split("=")[1],l),m=!0;break}if(/[A-Za-z]/.test(g[y])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(b)){n(g[y],b,l),m=!0;break}if(g[y+1]&&g[y+1].match(/\W/)){n(g[y],l.slice(y+2),l),m=!0;break}n(g[y],!s.strings[g[y]]||"",l)}else n(g[y],b,l)}f=l.slice(-1)[0];m||"-"===f||(!t[u+1]||/^(-|--)[^-]/.test(t[u+1])||s.bools[f]||c[f]&&o(f)?t[u+1]&&/^(true|false)$/.test(t[u+1])?(n(f,"true"===t[u+1],l),u++):n(f,!s.strings[f]||"",l):(n(f,t[u+1],l),u++))}else if(s.unknownFn&&!1===s.unknownFn(l)||a._.push(s.strings._||!J(l)?l:Number(l)),e.stopEarly){a._.push.apply(a._,t.slice(u+1));break}}return Object.keys(r).forEach(function(e){var t,i,n;t=a,i=e.split("."),n=t,i.slice(0,-1).forEach(function(t){n=n[t]||{}}),i[i.length-1]in n||(h(a,e.split("."),r[e]),(c[e]||[]).forEach(function(t){h(a,t.split("."),r[e])}))}),e["--"]?(a["--"]=new Array,i.forEach(function(t){a["--"].push(t)})):i.forEach(function(t){a._.push(t)}),a}var Y=function(){function o(i){Z(this,o);var t=(this.term=i).options,e=t.pixelRatio,n=t.fontSize,r=this.term.template.$canvas;this.scrollTop=0,this.scrollHeight=0,this.lineGap=10*e,this.fontSize=n*e,this.lineHeight=this.lineGap+this.fontSize,this.controlSize=6*e,this.controlColor=["#FF5F56","#FFBD2E","#27C93F"],this.renderIndex=-1,this.$watermark=null,this.$tmp=document.createElement("div"),this.ctx=j(r.getContext("2d")),this.contentPadding=[45,15,15,15].map(function(t){return t*e}),this.cacheEmits=[],this.cacheLines=[],this.renderLines=[],this.emit=this.emit.bind(this),this.clear=this.clear.bind(this),this.init(),this.cursor=!1,function t(){var e=this;setTimeout(function(){i.isDestroy||(e.cursor=!e.cursor,e.renderCursor(),t.call(e))},500)}.call(this)}return c(o,[{key:"init",value:function(){var t=this.term,e=t.template.$canvas,i=t.options,n=i.pixelRatio,r=i.fontFamily;this.canvasHeight=e.height,this.canvasWidth=e.width,this.contentHeight=this.canvasHeight-this.contentPadding[0]-this.contentPadding[2],this.contentWidth=this.canvasWidth-this.contentPadding[3]-this.contentPadding[1]/2,this.maxLength=Math.floor(this.contentHeight/this.lineHeight),this.ctx.textBaseline="top",this.ctx.font="".concat(this.fontSize,"px ").concat(r),this.term.emit("size",{header:this.contentPadding[0]/n,content:this.contentHeight/n,footer:this.contentPadding[2]/n}),this.loadWatermark(),this.render()}},{key:"render",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;return this.term.isDestroy||(this.renderBackground(),this.renderTopbar(),this.renderContent(),e&&this.autoScroll(),this.term.emit("render")),this}},{key:"renderBackground",value:function(){var t=this.term.options,e=t.background,i=t.pixelRatio,n=t.debug;if(this.ctx.fillStyle=e,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.$watermark){var r=this.$watermark,o=r.width/i,s=r.height/i,c=this.canvasWidth-o,a=this.canvasHeight-s;this.ctx.drawImage(this.$watermark,c,a,o,s)}n&&(this.ctx.fillStyle="green",this.ctx.fillRect(0,this.contentPadding[0],this.canvasWidth,i),this.ctx.fillRect(0,this.contentPadding[0]+this.contentHeight,this.canvasWidth,i),this.ctx.fillRect(this.contentPadding[3],0,i,this.canvasHeight),this.ctx.fillRect(this.contentPadding[3]+this.contentWidth,0,i,this.canvasHeight))}},{key:"loadWatermark",value:function(){var t=this,e=this.term.options.watermark;if(e&&(!this.$watermark||this.$watermark.src!==e)){var i=new Image;i.onload=function(){t.$watermark=i,t.render(!1)},i.src=e}}},{key:"renderTopbar",value:function(){var r=this,t=this.term.options,e=t.title,i=t.color,n=t.pixelRatio;this.ctx.fillStyle=i;var o=this.ctx.measureText(e).width;this.ctx.fillText(e,this.canvasWidth/2-o/2,this.contentPadding[1]-n/3),this.controlColor.forEach(function(t,e){r.ctx.beginPath();var i=r.contentPadding[3]+e*r.controlSize*3.6+r.controlSize,n=r.contentPadding[1]+r.controlSize;r.ctx.arc(i,n,r.controlSize,0,360,!1),r.ctx.fillStyle=t,r.ctx.fill(),r.ctx.closePath()})}},{key:"renderContent",value:function(){var t=this.term.options,e=t.pixelRatio,i=t.color,n=t.debug;if(this.renderLines.length)for(var r=0;r<this.renderLines.length;r+=1){var o=this.renderLines[r];if(o&&o.length)for(var s=0;s<o.length;s+=1){var c=o[s],a=this.contentPadding[0]+this.lineHeight*r;n&&(this.ctx.fillStyle="red",this.ctx.fillRect(0,a,this.canvasWidth,e),this.ctx.fillRect(0,a+this.fontSize,this.canvasWidth,e)),c.top=a,c.background&&(this.ctx.fillStyle=c.background,this.ctx.fillRect(c.left,a,c.width,this.fontSize)),this.ctx.fillStyle=c.color||i,this.ctx.fillText(c.text,c.left,a),(c.href||c.underline)&&this.ctx.fillRect(c.left,a+this.fontSize,c.width,e),c.del&&this.ctx.fillRect(c.left,a+Math.ceil(this.fontSize/2),c.width,e),c.border&&(this.ctx.fillRect(c.left,a,c.width,e),this.ctx.fillRect(c.left,a+this.fontSize-e,c.width,e),this.ctx.fillRect(c.left,a,e,this.fontSize),this.ctx.fillRect(c.left+c.width-e,a,e,this.fontSize))}}if(this.renderEditable){var h=this.cursorPos,u=h.left,l=h.top;this.term.emit("cursor",{left:u/e,top:l/e})}this.scrollHeight=this.cacheLines.length*this.lineHeight/e,this.term.emit("scrollHeight",this.scrollHeight)}},{key:"autoScroll",value:function(){var t=this.term.options.pixelRatio,e=this.renderLines[this.renderLines.length-1],i=this.cacheLines.indexOf(e);this.scrollTop=((i+1)*this.lineHeight-this.contentHeight)/t,this.term.emit("scrollTop",this.scrollTop)}},{key:"renderByIndex",value:function(t){this.renderIndex!==t&&(this.renderIndex=t,this.renderLines=this.cacheLines.slice(t,t+this.maxLength),this.render(!1))}},{key:"renderByTop",value:function(t){var e=this.term.options.pixelRatio,i=Math.ceil(t*e/this.lineHeight);this.renderByIndex(i)}},{key:"renderCursor",value:function(){var t=this.term.options,e=t.background,i=t.color,n=t.pixelRatio,r=this.cursorPos,o=r.left,s=r.top;this.renderEditable&&o&&s&&(this.ctx.fillStyle=this.cursor?i:e,this.ctx.fillRect(o,s,5*n,this.fontSize))}},{key:"emit",value:function(t){var e;if(f(t,{type:function(t){return!![D,B].includes(t)||'The type must be "'.concat(D,'" or "').concat(B,'"')},text:"string",prefix:"undefined|string",replace:"undefined|boolean"}),t.replace){this.cacheEmits.pop();var i=this.cacheLines[this.cacheLines.length-1];i&&i.groupId&&(this.cacheLines=this.cacheLines.filter(function(t){return t.groupId!==i.groupId}))}this.cacheEmits.push(V({},t));var n=this.parse(t);(e=this.cacheLines).push.apply(e,X(n)),this.renderLines=this.cacheLines.slice(-this.maxLength),this.render()}},{key:"parse",value:function(t){var e=this.term.options.prefix;t.type===D&&(t.text=(t.prefix||e)+E(t.text));for(var i=A(),n=[],r=t.text.split(/\r?\n/),o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=0,c=this.contentPadding[3],a=0;a<r.length;a+=1){var h=r[a];this.$tmp.innerHTML=h.replace(o,"");for(var u=0;u<this.$tmp.childNodes.length;u+=1){var l=this.$tmp.childNodes[u],d=l.textContent,f=this.ctx.measureText(d).width,p={};l.tagName&&(p.color=l.getAttribute("color"),p.background=l.getAttribute("background"),p.href=l.getAttribute("href"),p.border=l.hasAttribute("border"),p.underline=l.hasAttribute("underline"),p.del=l.hasAttribute("del"));var g=c+f;if(g>this.contentWidth){for(var m="",y=!1,b=c,v=X(d),x=0;x<v.length;x+=1){var I=v[x],w=this.ctx.measureText(I).width,k=c+w;if(k<=this.contentWidth)m+=I,c=k;else{var C=V({},t,{},p,{width:this.ctx.measureText(m).width,left:y?this.contentPadding[3]:b,text:m});n[s]?n[s].push(C):(n[s]=[C],n[s].groupId=i),s+=1,m=I,y=!0,c=this.contentPadding[3]+w}}var Q=V({},t,{},p,{width:this.ctx.measureText(m).width,left:y?this.contentPadding[3]:b,text:m});n[s]?n[s].push(Q):(n[s]=[Q],n[s].groupId=i)}else{var L=V({},t,{},p,{width:f,left:c,text:d});n[s]?n[s].push(L):(n[s]=[L],n[s].groupId=i),c=g}}s+=1,c=this.contentPadding[3]}return n.filter(Boolean)}},{key:"clear",value:function(){this.cacheEmits=[],this.cacheLines=[],this.renderLines=[],this.render()}},{key:"lastCacheLog",get:function(){var t=this.cacheLines[this.cacheLines.length-1];return t&&t[t.length-1]}},{key:"lastRenderLog",get:function(){var t=this.renderLines[this.renderLines.length-1];return t&&t[t.length-1]}},{key:"cacheEditable",get:function(){return this.term.isFocus&&this.lastCacheLog&&this.lastCacheLog.type===D}},{key:"renderEditable",get:function(){return this.cacheEditable&&this.lastCacheLog===this.lastRenderLog}},{key:"cursorPos",get:function(){if(this.renderEditable){var t=this.term.options.pixelRatio;return{left:this.lastRenderLog.left+this.lastRenderLog.width+2*t,top:this.contentPadding[0]+this.lineHeight*(this.renderLines.length-1)}}return{left:0,top:0}}}]),o}();function J(t){return"number"==typeof t||(/^0x[0-9a-f]+$/i.test(t)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t))}var K=function(){function r(t){var e=this;Z(this,r);var i=(this.term=t).drawer,n=t.options.welcome;this.isTyping=!1,this.typeTimer=null,this.askResolve=null,this.type=this.type.bind(this),this.input=this.input.bind(this),this.output=this.output.bind(this),this.ask=function(t){return C(!e.isQuestion,"The last problem has not been solved"),e.question(t)},this.output(n).input(),t.on("input",function(t){i.cacheEditable&&(e.isQuestion?e.question(i.lastCacheLog.prefix,t):e.input(t,!0))}),t.on("enter",function(t){i.cacheEditable&&t.trim()&&(e.isQuestion?(e.askResolve(t),e.askResolve=null):e.execute(t))}),t.on("abort",function(){e.stopType()})}return c(r,[{key:"execute",value:function(t){var n=this,e=0<arguments.length&&void 0!==t?t:"";if(!e.trim())return this.input();var i=this.term.options,r=i.parseOpt,o=i.notFound,s=i.loading,c=this.findAction(e),a=z(e.split(" "),r);if(!c){var h=o.call(this.term,e,a);return this.output(h).input()}if("function"!=typeof c.output)return this.output(c.output).input();try{var u=c.output.call(this.term,e,a);if("promise"!==f.kindOf(u))return void 0!==u?this.output(u).input():this;var l=s.call(this.term,e,a);return this.output(l),u.then(function(t){return void 0!==t?n.output(t,!0).input():n}).catch(function(t){var e="error"===f.kindOf(t)?"".concat(String(t)):"Error: ".concat(String(t)),i='<d color="red">'.concat(e,"</d>");return n.output(i,!0).input()})}catch(t){var d='<d color="red">'.concat(String(t),"</d>");return this.output(d).input()}}},{key:"findAction",value:function(i){return i=i.trim().toLowerCase(),this.term.options.actions.find(function(t){var e=f.kindOf(t.input);return"string"===e?i===t.input:"regexp"===e?t.input.test(i):null})}},{key:"output",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:"",n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:B,replace:n,text:String(i)}),this}},{key:"input",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:"",n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:D,replace:n,text:String(i)}),this}},{key:"question",value:function(t,e){var i=this,n=0<arguments.length&&void 0!==t?t:"",r=1<arguments.length&&void 0!==e?e:"";return this.isQuestion?this.term.drawer.emit({type:D,replace:!0,prefix:n,text:r}):new Promise(function(t){i.askResolve=t,i.term.drawer.emit({type:D,replace:!1,prefix:n,text:r})})}},{key:"type",value:function(t,e){var i=this,s=0<arguments.length&&void 0!==t?t:"",c=!(1<arguments.length&&void 0!==e)||e;if(this.isTyping)return Promise.reject();var a=this.term.template.$textarea;return new Promise(function(n){var r=X(s),o="";(function t(){var e=this;if(r.length){this.isTyping=!0;var i=r.shift();o+=i,this.input(o,!0),this.typeTimer=setTimeout(function(){e.term.isDestroy||t.call(e)},100)}else this.isTyping=!1,a.value=o,c&&(this.execute(o),a.value=""),n(o)}).call(i)})}},{key:"stopType",value:function(){clearTimeout(this.typeTimer)}},{key:"isQuestion",get:function(){var t=this.term.drawer,e=t.lastCacheLog;return t.cacheEditable&&e.prefix&&"function"==typeof this.askResolve}}]),r}(),q=function(){function e(t){Z(this,e),this.term=t,this.blobs=[]}return c(e,[{key:"start",value:function(){var e=this;C(!this.recording,"The recorder is recording...");var t=this.term.template.$canvas;this.stream=t.captureStream(30),C(this.stream,"Cannot get MediaStream of canvas"),C(MediaRecorder&&MediaRecorder.isTypeSupported(R.mimeType),"Does not support recording webm video"),this.recorder=new MediaRecorder(this.stream,R),this.recorder.ondataavailable=function(t){e.recording&&t.data&&0<t.data.size&&(e.blobs.push(t.data),e.term.emit("recording",{size:e.size,duration:e.duration}))},this.recorder.onstart=function(){e.term.emit("start")},this.recorder.onstop=function(){var t=URL.createObjectURL(new Blob(e.blobs));Q(t,"".concat(Date.now(),".webm")),URL.revokeObjectURL(t),e.blobs=[],e.term.emit("end")},this.recorder.start(1e3)}},{key:"end",value:function(){this.term.emit("creating"),this.recorder.stop()}},{key:"recording",get:function(){return this.recorder&&"recording"===this.recorder.state}},{key:"size",get:function(){return this.blobs.reduce(function(t,e){return t+e.size},0)}},{key:"duration",get:function(){return this.blobs.length}}]),e}(),tt=function(){function t(i){var n=this;Z(this,t),this.term=i,this.color="#66d9ef",this.radioTip="(select: Up or Down, confirm: Enter)",this.checkboxTip="(move: Up or Down, select: Space, confirm: Enter)",this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null},this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null},this.radio=function(t){return n.render(t,O)},this.checkbox=function(t){return n.render(t,F)},i.on("keydown",function(t){var e=i.drawer.lastCacheLog;e.style===O&&n.radioList===e.list&&n.radioEvent(t),e.style===F&&n.checkboxList===e.list&&n.checkboxEvent(t)})}return c(t,[{key:"render",value:function(e,i){var n=this;return new Promise(function(t){f(e,[{key:"string|number",text:"string|number"}]),C(e.length,"".concat(i," array cannot be empty")),C(e.map(function(t){return t.key}).every(function(t,e,i){return i.indexOf(t)===i.lastIndexOf(t)}),"The key value in the array element must be unique"),i===O&&(n.radioList=e,n.radioKey=e[0].key,n.radioResolve=t,n.radioRender(e,n.radioKey),n.radioInit=!0),i===F&&(n.checkboxList=e,n.checkboxIndex=0,n.checkboxKey=[],n.checkboxResolve=t,n.checkboxRender(),n.checkboxInit=!0)})}},{key:"radioRender",value:function(){var e=this,t=this.radioList.map(function(t){return e.radioKey===t.key?"<d color='".concat(e.color,"'>=> ").concat(t.text,"</d>"):"   ".concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.radioTip),list:this.radioList,type:B,style:O,replace:this.radioInit})}},{key:"radioEvent",value:function(t){var e=this,i=t.keyCode,n=this.radioList.findIndex(function(t){return t.key===e.radioKey});38===i&&(t.preventDefault(),this.radioKey=n<=0?this.radioList[this.radioList.length-1].key:this.radioList[n-1].key,this.radioRender()),40===i&&(t.preventDefault(),n===this.radioList.length-1?this.radioKey=this.radioList[0].key:this.radioKey=this.radioList[n+1].key,this.radioRender()),13===i&&(this.radioResolve(this.radioKey),this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null})}},{key:"checkboxRender",value:function(){var i=this,t=this.checkboxList.map(function(t,e){return e===i.checkboxIndex?"<d color='".concat(i.color,"'>").concat(i.checkboxKey.includes(t.key)?"":""," ").concat(t.text,"</d>"):"".concat(i.checkboxKey.includes(t.key)?"":""," ").concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.checkboxTip),list:this.checkboxList,type:B,style:F,replace:this.checkboxInit})}},{key:"checkboxEvent",value:function(t){var e=t.keyCode;if(38===e&&(t.preventDefault(),this.checkboxIndex<=0?this.checkboxIndex=this.checkboxList.length-1:--this.checkboxIndex,this.radioKey=this.checkboxList[this.checkboxIndex].key,this.checkboxRender()),40===e&&(t.preventDefault(),this.checkboxIndex===this.checkboxList.length-1?this.checkboxIndex=0:this.checkboxIndex+=1,this.checkboxRender()),32===e){var i=this.checkboxList[this.checkboxIndex].key,n=this.checkboxKey.indexOf(i);-1<n?this.checkboxKey.splice(n,1):this.checkboxKey.push(i),this.checkboxRender()}13===e&&(this.checkboxResolve(this.checkboxKey),this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null})}}]),t}();function et(t,e){var r="-",o="|",s=" ";return t.output(function i(t,e){var n=1<arguments.length&&void 0!==e?e:0;return t.map(function(t){var e=t.child&&t.child.length;return(n?o:"")+"".concat(s.repeat(n?4*n-1:0)).concat(o+r.repeat(2)," ").concat(t.value)+(e?"\n".concat(i(t.child,n+1)):"")}).join("\n")}(e))}function it(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function nt(n){return function(){var t,e=u(n);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=u(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return h(this,t)}}var rt=0,ot=[];return function(){e(n,l);var i=nt(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Z(this,n),(e=i.call(this)).options=f(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?it(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):it(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},n.default,{},t),n.scheme),e.isDestroy=!1,e.isFocus=!1,e.template=new S(r(e)),e.events=new U(r(e)),e.drawer=new Y(r(e)),e.commander=new K(r(e)),e.inquirer=new tt(r(e)),e.recorder=new q(r(e)),e.ask=e.commander.ask,e.type=e.commander.type,e.input=e.commander.input,e.output=e.commander.output,e.clear=e.drawer.clear,e.radio=e.inquirer.radio,e.checkbox=e.inquirer.checkbox,e.tree=function(t){return et(r(e),t)},rt+=1,e.id=rt,ot.push(r(e)),e}return c(n,null,[{key:"font",value:function(i,n){return new Promise(function(e,t){return window.FontFace?new FontFace(i,"url(".concat(n,")")).load().then(function(t){document.fonts.add(t),e(t)}):t(new Error("FontFace constructor is not supported"))})}},{key:"instances",get:function(){return ot}},{key:"version",get:function(){return"1.1.8"}},{key:"utils",get:function(){return L}},{key:"default",get:function(){return{container:"#term",debug:!1,width:600,height:500,actions:[],parseOpt:{},recorder:!0,draggable:!0,dragOpt:{},fontSize:13,watermark:"",autofocus:!1,fontFamily:"monospace",color:"#b0b2b6",title:"Term Web",prefix:'root@linux: ~ <d color="#00f501">$</d> ',welcome:"Last login: ".concat(new Date),loading:function(){return'<d color="yellow">Loading...</d>'},background:"rgb(42, 39, 52)",pixelRatio:window.devicePixelRatio,notFound:function(t){return"-bash: <d color='red'>".concat(t,"</d>: command not found")}}}},{key:"scheme",get:function(){return{container:"string|htmldivelement",debug:"boolean",width:"number",height:"number",actions:[{input:"string|regexp",output:"string|function"}],parseOpt:"object",recorder:"boolean",draggable:"boolean",dragOpt:"object",fontSize:"number",watermark:"string",autofocus:"boolean",fontFamily:"string",color:"string",title:"string",prefix:"string",welcome:"string",loading:"function",background:"string",pixelRatio:"number",notFound:"function"}}}]),c(n,[{key:"destroy",value:function(){ot.splice(ot.indexOf(this),1),this.events.destroy(),this.template.destroy(),this.isDestroy=!0,this.emit("destroy")}},{key:"color",set:function(t){this.options.color=t,this.drawer.init()},get:function(){return this.options.color}},{key:"background",set:function(t){this.options.background=t,this.drawer.init()},get:function(){return this.options.background}},{key:"watermark",set:function(t){this.options.watermark=t,this.drawer.init()},get:function(){return this.options.watermark}},{key:"width",set:function(t){this.emit("resize",{width:t,height:this.height})},get:function(){return this.template.$container.clientWidth}},{key:"height",set:function(t){this.emit("resize",{width:this.width,height:t})},get:function(){return this.template.$container.clientHeight}},{key:"debug",set:function(t){this.options.debug=t,this.drawer.init()},get:function(){return this.options.debug}}]),n}()});
