/*!
 * term-web.js v1.1.7
 * Github: https://github.com/zhw2590582/term-web#readme
 * (c) 2017-2020 Harvey Zack
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Term=e()}(this,function(){"use strict";var s=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t};var H=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var r=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t},o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var c=t(function(i){function n(t,e){return i.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}i.exports=n});var e=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)},i=t(function(e){function i(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=i=function(t){return typeof t}:e.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}e.exports=i});var u=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e},l=t(function(e){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}e.exports=i});!function(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}(".term-container{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;border-radius:5px;-webkit-box-shadow:rgba(0,0,0,.55) 0 20px 68px;box-shadow:0 20px 68px rgba(0,0,0,.55)}.term-container ::-webkit-scrollbar{width:5px}.term-container ::-webkit-scrollbar-thumb{background-color:#666;border-radius:5px}.term-container ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.term-container.is-dragging{opacity:.95}.term-container.is-fullscreen{position:fixed!important;z-index:9999!important;top:0!important;left:0!important;bottom:0!important;right:0!important;width:100%!important;height:100%!important}.term-container .term-canvas{position:absolute;z-index:1;top:0;left:0;bottom:0;right:0;width:100%;height:100%}.term-container .term-textarea{z-index:2}.term-container .term-copy,.term-container .term-textarea{position:absolute;width:20px;height:20px;opacity:0;pointer-events:none;resize:none}.term-container .term-copy{z-index:3}.term-container .term-header{position:absolute;z-index:4;width:100%;top:0;left:0;right:0}.term-container .term-header .term-recorder{position:absolute;right:10px;top:10px;height:18px;width:18px;border-radius:3px;cursor:pointer;border-style:solid;border-width:0;background:#f44336;-webkit-transition:all .2s ease;transition:all .2s ease}@-webkit-keyframes loop{0%{border-width:1px}50%{border-width:6px}to{border-width:1px}}@keyframes loop{0%{border-width:1px}50%{border-width:6px}to{border-width:1px}}.term-container .term-header .term-recorder.recording{background:#ff5722}.term-container .term-header .term-recorder.creating,.term-container .term-header .term-recorder.recording{border-color:rgba(255,254,254,.5);border-radius:50%;-webkit-animation:loop 1s linear infinite;animation:loop 1s linear infinite}.term-container .term-header .term-recorder.creating{background:#009688}.term-container .term-content{position:absolute;z-index:5;width:100%;right:0;left:0;overflow:auto}.term-container .term-content:hover{cursor:text}.term-container .term-footer{position:absolute;z-index:6;width:100%;bottom:0;left:0;right:0}.term-container .term-footer .term-resize{position:absolute;right:0;bottom:0;width:20px;height:20px;cursor:nwse-resize}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsZ0JBQ0UsaUJBQWtCLENBQ2xCLHdCQUFpQixDQUFqQixxQkFBaUIsQ0FBakIsb0JBQWlCLENBQWpCLGdCQUFpQixDQUNqQixlQUFnQixDQUNoQixpQkFBa0IsQ0FDbEIsOENBQTZDLENBQTdDLHNDQUErQyxDQUMvQyxvQ0FDRSxTQUFZLENBQ2QsMENBQ0UscUJBQXNCLENBQ3RCLGlCQUFvQixDQUN0QixnREFDRSxxQkFBd0IsQ0FDMUIsNEJBQ0UsV0FBZSxDQUNqQiw4QkFDRSx3QkFBMEIsQ0FDMUIsc0JBQXdCLENBQ3hCLGVBQWlCLENBQ2pCLGdCQUFrQixDQUNsQixrQkFBb0IsQ0FDcEIsaUJBQW1CLENBQ25CLG9CQUFzQixDQUN0QixxQkFBeUIsQ0FDM0IsNkJBQ0UsaUJBQWtCLENBQ2xCLFNBQVUsQ0FDVixLQUFNLENBQ04sTUFBTyxDQUNQLFFBQVMsQ0FDVCxPQUFRLENBQ1IsVUFBVyxDQUNYLFdBQWMsQ0FDaEIsK0JBRUUsU0FLYyxDQUNoQiwwREFQRSxpQkFBa0IsQ0FFbEIsVUFBVyxDQUNYLFdBQVksQ0FDWixTQUFVLENBQ1YsbUJBQW9CLENBQ3BCLFdBUWMsQ0FQaEIsMkJBRUUsU0FLYyxDQUNoQiw2QkFDRSxpQkFBa0IsQ0FDbEIsU0FBVSxDQUNWLFVBQVcsQ0FDWCxLQUFNLENBQ04sTUFBTyxDQUNQLE9BQVUsQ0FDViw0Q0FDRSxpQkFBa0IsQ0FDbEIsVUFBVyxDQUNYLFFBQVMsQ0FDVCxXQUFZLENBQ1osVUFBVyxDQUNYLGlCQUFrQixDQUNsQixjQUFlLENBQ2Ysa0JBQW1CLENBQ25CLGNBQWUsQ0FDZixrQkFBbUIsQ0FDbkIsK0JBQXlCLENBQXpCLHVCQUEyQixDQUVqQyx3QkFDRSxHQUNFLGdCQUFtQixDQUNyQixJQUNFLGdCQUFtQixDQUNyQixHQUNFLGdCQUFtQixDQUFFLENBTnpCLGdCQUNFLEdBQ0UsZ0JBQW1CLENBQ3JCLElBQ0UsZ0JBQW1CLENBQ3JCLEdBQ0UsZ0JBQW1CLENBQUUsQ0FDbkIsc0RBQ0Usa0JBR29DLENBQ3RDLDJHQUhFLGlDQUFzQyxDQUN0QyxpQkFBa0IsQ0FDbEIseUNBQWtDLENBQWxDLGlDQUtvQyxDQUp0QyxxREFDRSxrQkFHb0MsQ0FDMUMsOEJBQ0UsaUJBQWtCLENBQ2xCLFNBQVUsQ0FDVixVQUFXLENBQ1gsT0FBUSxDQUNSLE1BQU8sQ0FDUCxhQUFnQixDQUNoQixvQ0FDRSxXQUFjLENBQ2xCLDZCQUNFLGlCQUFrQixDQUNsQixTQUFVLENBQ1YsVUFBVyxDQUNYLFFBQVMsQ0FDVCxNQUFPLENBQ1AsT0FBVSxDQUNWLDBDQUNFLGlCQUFrQixDQUNsQixPQUFRLENBQ1IsUUFBUyxDQUNULFVBQVcsQ0FDWCxXQUFZLENBQ1osa0JBQXFCIiwiZmlsZSI6ImluZGV4LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGVybS1jb250YWluZXIge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIHVzZXItc2VsZWN0OiBub25lO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIGJveC1zaGFkb3c6IHJnYmEoMCwgMCwgMCwgMC41NSkgMHB4IDIwcHggNjhweDsgfVxuICAudGVybS1jb250YWluZXIgOjotd2Via2l0LXNjcm9sbGJhciB7XG4gICAgd2lkdGg6IDVweDsgfVxuICAudGVybS1jb250YWluZXIgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzY2NjtcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7IH1cbiAgLnRlcm0tY29udGFpbmVyIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNjY2M7IH1cbiAgLnRlcm0tY29udGFpbmVyLmlzLWRyYWdnaW5nIHtcbiAgICBvcGFjaXR5OiAwLjk1OyB9XG4gIC50ZXJtLWNvbnRhaW5lci5pcy1mdWxsc2NyZWVuIHtcbiAgICBwb3NpdGlvbjogZml4ZWQgIWltcG9ydGFudDtcbiAgICB6LWluZGV4OiA5OTk5ICFpbXBvcnRhbnQ7XG4gICAgdG9wOiAwICFpbXBvcnRhbnQ7XG4gICAgbGVmdDogMCAhaW1wb3J0YW50O1xuICAgIGJvdHRvbTogMCAhaW1wb3J0YW50O1xuICAgIHJpZ2h0OiAwICFpbXBvcnRhbnQ7XG4gICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDtcbiAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDsgfVxuICAudGVybS1jb250YWluZXIgLnRlcm0tY2FudmFzIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgei1pbmRleDogMTtcbiAgICB0b3A6IDA7XG4gICAgbGVmdDogMDtcbiAgICBib3R0b206IDA7XG4gICAgcmlnaHQ6IDA7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiAxMDAlOyB9XG4gIC50ZXJtLWNvbnRhaW5lciAudGVybS10ZXh0YXJlYSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDI7XG4gICAgd2lkdGg6IDIwcHg7XG4gICAgaGVpZ2h0OiAyMHB4O1xuICAgIG9wYWNpdHk6IDA7XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgcmVzaXplOiBub25lOyB9XG4gIC50ZXJtLWNvbnRhaW5lciAudGVybS1jb3B5IHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgei1pbmRleDogMztcbiAgICB3aWR0aDogMjBweDtcbiAgICBoZWlnaHQ6IDIwcHg7XG4gICAgb3BhY2l0eTogMDtcbiAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgICByZXNpemU6IG5vbmU7IH1cbiAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWhlYWRlciB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDQ7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgdG9wOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgcmlnaHQ6IDA7IH1cbiAgICAudGVybS1jb250YWluZXIgLnRlcm0taGVhZGVyIC50ZXJtLXJlY29yZGVyIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHJpZ2h0OiAxMHB4O1xuICAgICAgdG9wOiAxMHB4O1xuICAgICAgaGVpZ2h0OiAxOHB4O1xuICAgICAgd2lkdGg6IDE4cHg7XG4gICAgICBib3JkZXItcmFkaXVzOiAzcHg7XG4gICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICAgICAgYm9yZGVyLXdpZHRoOiAwO1xuICAgICAgYmFja2dyb3VuZDogI2Y0NDMzNjtcbiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7IH1cblxuQGtleWZyYW1lcyBsb29wIHtcbiAgMCUge1xuICAgIGJvcmRlci13aWR0aDogMXB4OyB9XG4gIDUwJSB7XG4gICAgYm9yZGVyLXdpZHRoOiA2cHg7IH1cbiAgMTAwJSB7XG4gICAgYm9yZGVyLXdpZHRoOiAxcHg7IH0gfVxuICAgICAgLnRlcm0tY29udGFpbmVyIC50ZXJtLWhlYWRlciAudGVybS1yZWNvcmRlci5yZWNvcmRpbmcge1xuICAgICAgICBiYWNrZ3JvdW5kOiAjZmY1NzIyO1xuICAgICAgICBib3JkZXItY29sb3I6IHJnYmEoMjU1LCAyNTQsIDI1NCwgMC41KTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICAgICAgICBhbmltYXRpb246IGxvb3AgMXMgbGluZWFyIGluZmluaXRlOyB9XG4gICAgICAudGVybS1jb250YWluZXIgLnRlcm0taGVhZGVyIC50ZXJtLXJlY29yZGVyLmNyZWF0aW5nIHtcbiAgICAgICAgYmFja2dyb3VuZDogIzAwOTY4ODtcbiAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDI1NSwgMjU0LCAyNTQsIDAuNSk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgYW5pbWF0aW9uOiBsb29wIDFzIGxpbmVhciBpbmZpbml0ZTsgfVxuICAudGVybS1jb250YWluZXIgLnRlcm0tY29udGVudCB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDU7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcmlnaHQ6IDA7XG4gICAgbGVmdDogMDtcbiAgICBvdmVyZmxvdzogYXV0bzsgfVxuICAgIC50ZXJtLWNvbnRhaW5lciAudGVybS1jb250ZW50OmhvdmVyIHtcbiAgICAgIGN1cnNvcjogdGV4dDsgfVxuICAudGVybS1jb250YWluZXIgLnRlcm0tZm9vdGVyIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgei1pbmRleDogNjtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBib3R0b206IDA7XG4gICAgbGVmdDogMDtcbiAgICByaWdodDogMDsgfVxuICAgIC50ZXJtLWNvbnRhaW5lciAudGVybS1mb290ZXIgLnRlcm0tcmVzaXplIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHJpZ2h0OiAwO1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgd2lkdGg6IDIwcHg7XG4gICAgICBoZWlnaHQ6IDIwcHg7XG4gICAgICBjdXJzb3I6IG53c2UtcmVzaXplOyB9XG4iXX0= */");var f=t(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return t.constructor?t.constructor.name:null}function c(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:["option"];return u(t,e,i),l(t,e,i),function(o,s,a){var t=h(s),e=h(o);if("object"===t){if("object"!==e)throw new Error("[Type Error]: '".concat(a.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(s).forEach(function(t){var e=o[t],i=s[t],n=a.slice();n.push(t),u(e,i,n),l(e,i,n),c(e,i,n)})}if("array"===t){if("array"!==e)throw new Error("[Type Error]: '".concat(a.join("."),"' require 'array' type, but got '").concat(e,"'"));o.forEach(function(t,e){var i=o[e],n=s[e]||s[0],r=a.slice();r.push(e),u(i,n,r),l(i,n,r),c(i,n,r)})}}(t,e,i),t}function u(t,e,i){if("string"===h(e)){var n=h(t);if(!(-1<e.indexOf("|")?e.split("|").map(function(t){return t.toLowerCase().trim()}).filter(Boolean).some(function(t){return n===t}):e.toLowerCase().trim()===n))throw new Error("[Type Error]: '".concat(i.join("."),"' require '").concat(e,"' type, but got '").concat(n,"'"))}}function l(t,e,i){if("function"===h(e)){var n=e(t,h(t),i);if(!0!==n){var r=h(n);throw"string"===r?new Error(n):"error"===r?n:new Error("[Validator Error]: The scheme for '".concat(i.join("."),"' validator require return true, but got '").concat(n,"'"))}}}var o,h;t.exports=(o=Object.prototype.toString,c.kindOf=h=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e,i=n(t);if("boolean"===i)return"boolean";if("string"===i)return"string";if("number"===i)return"number";if("symbol"===i)return"symbol";if("function"===i)return"GeneratorFunction"===r(t)?"generatorfunction":"function";if(e=t,Array.isArray?Array.isArray(e):e instanceof Array)return"array";if(t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return 1}catch(t){if(-1!==t.message.indexOf("callee"))return 1}}(t))return"arguments";if(t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate)return"date";if(t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit)return"error";if(t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global)return"regexp";switch(r(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next)return"generator";switch(i=o.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return i.slice(8,-1).toLowerCase().replace(/\s/g,"")},c)}),h=function(){function t(){H(this,t)}return a(t,[{key:"on",value:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this}},{key:"once",value:function(n,r,o){var s=this;function a(){s.off(n,a);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];r.apply(o,e)}return a._=r,this.on(n,a,o)}},{key:"emit",value:function(t){for(var e=((this.e||(this.e={}))[t]||[]).slice(),i=arguments.length,n=new Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var o=0;o<e.length;o+=1)e[o].fn.apply(e[o].ctx,n);return this}},{key:"off",value:function(t,e){var i=this.e||(this.e={}),n=i[t],r=[];if(n&&e)for(var o=0,s=n.length;o<s;o+=1)n[o].fn!==e&&n[o].fn._!==e&&r.push(n[o]);return r.length?i[t]=r:delete i[t],this}}]),t}();var d=t(function(t){var e,i;e=window,i=function(){function v(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var i="undefined"==typeof console?function(){}:function(t){console.error(t)},b=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],y=b.length;function x(t){var e=getComputedStyle(t);return e||i("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}var w,C=!1;function I(t){if(!function(){if(!C){C=!0;var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style.boxSizing="border-box";var e=document.body||document.documentElement;e.appendChild(t);var i=x(t);w=200==Math.round(v(i.width)),I.isBoxSizeOuter=w,e.removeChild(t)}}(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var e=x(t);if("none"==e.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<y;e++){t[b[e]]=0}return t}();var i={};i.width=t.offsetWidth,i.height=t.offsetHeight;for(var n=i.isBorderBox="border-box"==e.boxSizing,r=0;r<y;r++){var o=b[r],s=e[o],a=parseFloat(s);i[o]=isNaN(a)?0:a}var c=i.paddingLeft+i.paddingRight,u=i.paddingTop+i.paddingBottom,l=i.marginLeft+i.marginRight,h=i.marginTop+i.marginBottom,d=i.borderLeftWidth+i.borderRightWidth,f=i.borderTopWidth+i.borderBottomWidth,p=n&&w,g=v(e.width);!1!==g&&(i.width=g+(p?0:c+d));var m=v(e.height);return!1!==m&&(i.height=m+(p?0:u+f)),i.innerWidth=i.width-(c+d),i.innerHeight=i.height-(u+f),i.outerWidth=i.width+l,i.outerHeight=i.height+h,i}}return I},t.exports?t.exports=i():e.getSize=i()}),p=t(function(t){var e,i;e="undefined"!=typeof window?window:o,i=function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r];n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t},t.exports?t.exports=i():e.EvEmitter=i()}),g=t(function(t){var e,i;e=window,i=function(r,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindStartEvent=function(t){this._bindStartEvent(t,!0)},i.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},i._bindStartEvent=function(t,e){var i=(e=void 0===e||e)?"addEventListener":"removeEventListener",n="mousedown";r.PointerEvent?n="pointerdown":"ontouchstart"in r&&(n="touchstart"),t[i](n,this)},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},i.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},i.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},i.onpointerdown=function(t){this._pointerDown(t,t)},i._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},i.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var n={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return i._bindPostStartEvents=function(t){if(t){var e=n[t.type];e.forEach(function(t){r.addEventListener(t,this)},this),this._boundPointerEvents=e}},i._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(t){r.removeEventListener(t,this)},this),delete this._boundPointerEvents)},i.onmousemove=function(t){this._pointerMove(t,t)},i.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},i.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},i._pointerMove=function(t,e){this.pointerMove(t,e)},i.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},i.onmouseup=function(t){this._pointerUp(t,t)},i.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},i.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},i._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},i._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},i._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},i.pointerDone=function(){},i.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},i.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},i._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},i.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},e.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},e},t.exports?t.exports=i(e,p):e.Unipointer=i(e,e.EvEmitter)}),m=t(function(t){var e,i;e=window,i=function(o,t){function e(){}var i=e.prototype=Object.create(t.prototype);i.bindHandles=function(){this._bindHandles(!0)},i.unbindHandles=function(){this._bindHandles(!1)},i._bindHandles=function(t){for(var e=(t=void 0===t||t)?"addEventListener":"removeEventListener",i=t?this._touchActionValue:"",n=0;n<this.handles.length;n++){var r=this.handles[n];this._bindStartEvent(r,t),r[e]("click",this),o.PointerEvent&&(r.style.touchAction=i)}},i._touchActionValue="none",i.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer={pageX:e.pageX,pageY:e.pageY},t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var r={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return i.okayPointerDown=function(t){var e=r[t.target.nodeName],i=s[t.target.type],n=!e||i;return n||this._pointerReset(),n},i.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},i.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},i._dragPointerMove=function(t,e){var i={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(t,e),i},i.hasDragStarted=function(t){return 3<Math.abs(t.x)||3<Math.abs(t.y)},i.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},i._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},i._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},i.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},i._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},i.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},i._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},i.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},i.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},i._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},i.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},e.getPointerPoint=t.getPointerPoint,e},t.exports?t.exports=i(e,g):e.Unidragger=i(e,e.Unipointer)}),v=t(function(t){var e,i;e=window,i=function(o,c,t){function i(t,e){for(var i in e)t[i]=e[i];return t}var n=o.jQuery;function e(t,e){this.element="string"==typeof t?document.querySelector(t):t,n&&(this.$element=n(this.element)),this.options=i({},this.constructor.defaults),this.option(e),this._create()}var r=e.prototype=Object.create(t.prototype);e.defaults={},r.option=function(t){i(this.options,t)};var s={relative:!0,absolute:!0,fixed:!0};function u(t,e,i){return i=i||"round",e?Math[i](t/e)*e:t}return r._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=i({},this.position);var t=getComputedStyle(this.element);s[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},r.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},r.dispatchEvent=function(t,e,i){var n=[e].concat(i);this.emitEvent(t,n),this.dispatchJQueryEvent(t,e,i)},r.dispatchJQueryEvent=function(t,e,i){var n=o.jQuery;if(n&&this.$element){var r=n.Event(e);r.type=t,this.$element.trigger(r,i)}},r._getPosition=function(){var t=getComputedStyle(this.element),e=this._getPositionCoord(t.left,"width"),i=this._getPositionCoord(t.top,"height");this.position.x=isNaN(e)?0:e,this.position.y=isNaN(i)?0:i,this._addTransformPosition(t)},r._getPositionCoord=function(t,e){if(-1==t.indexOf("%"))return parseInt(t,10);var i=c(this.element.parentNode);return i?parseFloat(t)/100*i[e]:0},r._addTransformPosition=function(t){var e=t.transform;if(0===e.indexOf("matrix")){var i=e.split(","),n=0===e.indexOf("matrix3d")?12:4,r=parseInt(i[n],10),o=parseInt(i[1+n],10);this.position.x+=r,this.position.y+=o}},r.onPointerDown=function(t,e){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[e])},r.dragStart=function(t,e){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[e]),this.animate())},r.measureContainment=function(){var t=this.getContainer();if(t){var e=c(this.element),i=c(t),n=this.element.getBoundingClientRect(),r=t.getBoundingClientRect(),o=i.borderLeftWidth+i.borderRightWidth,s=i.borderTopWidth+i.borderBottomWidth,a=this.relativeStartPosition={x:n.left-(r.left+i.borderLeftWidth),y:n.top-(r.top+i.borderTopWidth)};this.containSize={width:i.width-o-a.x-e.width,height:i.height-s-a.y-e.height}}},r.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},r.onPointerMove=function(t,e,i){this.dispatchJQueryEvent("pointerMove",t,[e,i])},r.dragMove=function(t,e,i){if(this.isEnabled){var n=i.x,r=i.y,o=this.options.grid,s=o&&o[0],a=o&&o[1];n=u(n,s),r=u(r,a),n=this.containDrag("x",n,s),r=this.containDrag("y",r,a),n="y"==this.options.axis?0:n,r="x"==this.options.axis?0:r,this.position.x=this.startPosition.x+n,this.position.y=this.startPosition.y+r,this.dragPoint.x=n,this.dragPoint.y=r,this.dispatchEvent("dragMove",t,[e,i])}},r.containDrag=function(t,e,i){if(!this.options.containment)return e;var n="x"==t?"width":"height",r=u(-this.relativeStartPosition[t],i,"ceil"),o=this.containSize[n];return o=u(o,i,"floor"),Math.max(r,Math.min(o,e))},r.onPointerUp=function(t,e){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[e])},r.dragEnd=function(t,e){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[e]))},r.animate=function(){if(this.isDragging){this.positionDrag();var t=this;requestAnimationFrame(function(){t.animate()})}},r.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},r.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},r.staticClick=function(t,e){this.dispatchEvent("staticClick",t,[e])},r.setPosition=function(t,e){this.position.x=t,this.position.y=e,this.setLeftTop()},r.enable=function(){this.isEnabled=!0},r.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},r.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},r._init=function(){},n&&n.bridget&&n.bridget("draggabilly",e),e},t.exports?t.exports=i(e,d,m):e.Draggabilly=i(e,e.getSize,e.Unidragger)});function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function X(t,e){var i=t.options,n=i.dragOpt,r=i.draggable,o=t.template.$container;r&&(e.draggie=new v(o,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({handle:".term-header"},n)),t.on("destroy",function(){e.draggie.destroy()}))}var y=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")};var x=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}},w=t(function(n){function r(t,e,i){return x()?n.exports=r=Reflect.construct:n.exports=r=function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&c(r,i.prototype),r},r.apply(null,arguments)}n.exports=r});function C(n){return function(){var t,e=l(n);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=l(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return u(this,t)}}var I=function(t){e(n,t);var i=C(n);function n(t){var e;return H(this,n),(e=i.call(this,t)).name="TermError",e}return n}(t(function(e){function n(t){var i="function"==typeof Map?new Map:void 0;return e.exports=n=function(t){if(null===t||!y(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,e)}function e(){return w(t,arguments,l(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),c(e,t)},n(t)}e.exports=n})(Error));function k(t,e){if(!t)throw new I(e);return t}function E(t,e){var i=document.createElement("a");i.style.display="none",i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function z(n,r,o){var s;return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];clearTimeout(s),s=setTimeout(function(){s=null,n.apply(o,e)},r)}}function L(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}function O(t){return t.replace(/[&<>'"]/g,function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[t]||t})}var A=Object.freeze({__proto__:null,TermError:I,errorHandle:k,clamp:function(t,e,i){return Math.max(Math.min(t,Math.max(e,i)),Math.min(e,i))},download:E,debounce:z,uuid:L,escape:O,unescape:function(t){return t.replace(/&amp;|&lt;|&gt;|&#39;|&quot;/g,function(t){return{"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'}[t]||t})}});var F="input",S="output",Q="radio",D="checkbox",U={videoBitsPerSecond:5e6,mimeType:"video/webm"};function _(o){var s=o.template.$textarea,a=0;o.on("enter",function(){a=0}),o.on("render",function(){o.drawer&&!o.drawer.renderEditable&&(a=0)}),o.on("history",function(t){var e,i,n,r;e=t,i=o.drawer.cacheEmits,n=i.filter(function(t,e){return t.type===F&&t.text.trim()&&e!==i.length-1}),(r=n[n.length+a+e])&&(a+=e,s.value=r.text,o.drawer.emit({type:F,text:r.text,replace:!0}))})}var B=function(){function N(t){var e,i,n,r,o,s,a,c,u,l,h,d,f,p,g,m,v,b,y,x,w,C,I,k,E,A,L,O,F,S,Q,D,U,B,R,W,G,T,j,P,V,M;H(this,N),this.term=t,this.destroyEvents=[],this.proxy=this.proxy.bind(this),i=this,n=(e=t).template.$textarea,i.proxy(document,["click","contextmenu","dblclick"],function(t){t.composedPath&&-1<t.composedPath().indexOf(e.template.$content)?(e.isFocus=!0,e.emit("focus"),e.emit(t.type,t)):(e.isFocus=!1,e.emit("blur"))}),e.on("focus",function(){n.focus()}),e.on("click",function(t){var e=i.getLogFromEvent(t).log;e&&e.href&&window.open(e.href)}),o=this,s=(r=t).template,a=s.$container,c=s.$content,u=s.$resize,l=s.$canvas,h=s.$header,d=s.$footer,f=r.options.pixelRatio,p=!1,b=v=m=g=0,o.proxy(u,"mousedown",function(t){p=!0;var e=a.clientWidth,i=a.clientHeight;v=e,b=i,g=t.pageX,m=t.pageY}),o.proxy(document,"mousemove",function(t){if(p){c.style.visibility="hidden";var e=v+t.pageX-g,i=b+t.pageY-m;300<=e&&300<=i&&(a.style.width="".concat(e,"px"),a.style.height="".concat(i,"px"))}}),o.proxy(document,"mouseup",function(){if(p){p=!1,b=v=m=g=0,c.style.visibility="visible";var t=a.clientWidth,e=a.clientHeight;r.emit("resize",{width:t,height:e})}}),r.on("resize",function(t){var e=t.width,i=t.height;a.style.width="".concat(e,"px"),a.style.height="".concat(i,"px"),l.width=e*f,l.height=i*f,r.drawer.init()}),r.on("size",function(t){var e=t.header,i=t.content,n=t.footer;h.style.height="".concat(e,"px"),d.style.height="".concat(n,"px"),c.style.top="".concat(e,"px"),c.style.height="".concat(i,"px")}),X(t,this),x=this,w=(y=t).template.$textarea,x.proxy(w,"input",function(){y.emit("input",w.value.trim())}),x.proxy(w,"paste",function(){y.emit("input",w.value.trim())}),y.on("cursor",function(t){var e=t.left,i=t.top;w.style.top="".concat(i,"px"),w.style.left="".concat(e,"px")}),function(t,e){var i=t.options,n=i.recordType;if(i.recorder){var r=t.template.$recorder;e.proxy(r,"click",function(){t[n].recording?t[n].end():t[n].start()}),t.on("start",function(){r.classList.remove("creating"),r.classList.add("recording")}),t.on("creating",function(){r.classList.remove("recording"),r.classList.add("creating")}),t.on("end",function(){r.classList.remove("recording"),r.classList.remove("creating")})}}(t,this),I=this,k=(C=t).template,E=k.$content,A=k.$scrollbar,L=!1,I.proxy(E,"scroll",function(){L?C.drawer.renderByTop(E.scrollTop):L=!0}),C.on("scrollTop",function(t){L?L=!1:E.scrollTop=t}),C.on("scrollHeight",function(t){A.style.height="".concat(t,"px")}),F=this,S=(O=t).template.$copy,Q=[],D=0,O.on("click",function(){if(O.drawer.render(!1),D&&Q.length&&Date.now()-D<=300){var t=O.drawer,e=t.fontSize,i=t.ctx,n=t.contentWidth,r=t.contentPadding,o=O.options,s=o.backgroundColor,a=o.fontColor,c=Q.reduce(function(t,e){return t+e.text},"");i.fillStyle=a,i.fillRect(r[3],Q[0].top,n,e),i.fillStyle=s,i.fillText(c,r[3],Q[0].top),S.value=c,S.focus(),S.select()}else Q=[],D=0,S.value=""}),O.on("dblclick",function(t){O.drawer.render(!1);var e=F.getLogFromEvent(t),i=e.logs,n=e.log;if(Q=[],D=0,S.value="",n){var r=O.drawer,o=r.ctx,s=r.fontSize,a=O.options,c=a.backgroundColor,u=a.fontColor;Q=i,D=Date.now(),o.fillStyle=u,o.fillRect(n.left,n.top,n.width,s),o.fillStyle=c,o.fillText(n.text,n.left,n.top),S.value=n.text,S.focus(),S.select()}}),O.on("blur",function(){O.drawer.render(!1),Q=[],D=0,S.value=""}),B=this,R=(U=t).template,W=R.$container,G=R.$header,T=!1,j=z(function(){var t=document.body.getBoundingClientRect(),e=t.width,i=t.height;U.emit("resize",{width:e,height:i})},100),U.on("fullscreen",function(t){(T=t)?(j(),W.classList.add("is-fullscreen"),B.draggie&&B.draggie.disable()):(W.classList.remove("is-fullscreen"),U.emit("resize",{width:U.options.width,height:U.options.height}),B.draggie&&B.draggie.enable())}),B.proxy(G,"dblclick",function(){U.emit("fullscreen",!T)}),B.proxy(window,"resize",function(){T&&j()}),_(t),V=this,M=(P=t).template.$textarea,V.proxy(M,"keydown",function(t){P.emit("keydown",t);var e=t.keyCode;13===e&&(P.emit("enter",M.value.trim()),M.value=""),t.ctrlKey&&67===e&&(M.value="",P.input(),P.emit("abort")),[37,38,39,40].includes(e)&&t.preventDefault(),P.drawer.renderEditable&&(38===e&&P.emit("history",-1),40===e&&P.emit("history",1))})}return a(N,[{key:"getLogFromEvent",value:function(t){var e=this.term.template.$content,i=this.term.options.pixelRatio,n=e.getBoundingClientRect(),r=(t.pageX-n.left)*i,o=(t.pageY-n.top)*i,s=this.term.drawer,a=s.renderLogs,c=s.lineHeight,u=a[Math.floor(o/c)]||[],l=u.find(function(t){return r>t.left&&t.left+t.width>=r});return{logs:u,log:l}}},{key:"proxy",value:function(e,t,i,n){var r=this,o=3<arguments.length&&void 0!==n?n:{};Array.isArray(t)?t.forEach(function(t){return r.proxy(e,t,i,o)}):(e.addEventListener(t,i,o),this.destroyEvents.push(function(){e.removeEventListener(t,i,o)}))}},{key:"destroy",value:function(){this.destroyEvents.forEach(function(t){return t()})}}]),N}(),R=function(){function c(t){var e=this;H(this,c);var i=(this.term=t).options,n=i.container,r=i.pixelRatio,o=i.width,s=i.height,a=i.recorder;this.$container=n,"string"==typeof t.options.container&&(this.$container=document.querySelector(t.options.container)),k(t.constructor.instances.every(function(t){return t.template.$container!==e.$container}),"Cannot mount multiple instances on the same dom element, please destroy the previous instance first."),this.$container.classList.add("term-container"),this.$container.style.width="".concat(o,"px"),this.$container.style.height="".concat(s,"px"),this.$canvas=document.createElement("canvas"),this.$canvas.classList.add("term-canvas"),this.$canvas.width=o*r,this.$canvas.height=s*r,this.$container.appendChild(this.$canvas),this.$textarea=document.createElement("textarea"),this.$textarea.classList.add("term-textarea"),this.$container.appendChild(this.$textarea),this.$copy=document.createElement("textarea"),this.$copy.classList.add("term-copy"),this.$container.appendChild(this.$copy),this.$header=document.createElement("div"),this.$header.classList.add("term-header"),this.$container.appendChild(this.$header),this.$content=document.createElement("div"),this.$content.classList.add("term-content"),this.$container.appendChild(this.$content),this.$scrollbar=document.createElement("div"),this.$scrollbar.classList.add("term-scrollbar"),this.$scrollbar.style.height="0",this.$content.appendChild(this.$scrollbar),this.$footer=document.createElement("div"),this.$footer.classList.add("term-footer"),this.$container.appendChild(this.$footer),this.$resize=document.createElement("div"),this.$resize.classList.add("term-resize"),this.$footer.appendChild(this.$resize),a&&(this.$recorder=document.createElement("div"),this.$recorder.classList.add("term-recorder"),this.$header.appendChild(this.$recorder))}return a(c,[{key:"destroy",value:function(){this.$container.classList.remove("term-container"),this.$container.innerHTML=""}}]),c}();var W=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n};var G=function(t){if(Array.isArray(t))return W(t)};var T=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)};var j=function(t,e){if(t){if("string"==typeof t)return W(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?W(t,e):void 0}};var P=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var V=function(t){return G(t)||T(t)||j(t)||P()},M=t(function(t,e){t.exports=function(){var t=document.createElement("canvas");t.style.position="fixed",t.style.left="-999px",t.style.top="-999px",t.width=100,t.height=100,document.body.appendChild(t);var e=t.getContext("2d");e.textBaseline="top",e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,100,100),e.fillStyle="rgb(255, 255, 255)",e.fillText("T",0,10);for(var o={},i=1;i<=100;i++){e.fillStyle="rgb(0, 0, 0)";e.fillRect(0,0,100,100);e.fillStyle="rgb(255, 255, 255)";e.font=i+"px Arial";e.fillText("T",0,10);var n=5*i/10;for(var r=0;r<20;r++){var s=e.getImageData(n,r,1,1).data;if(s[0]!==0&&s[1]!==0&&s[2]!==0){o[i]=r-10;break}}}return document.body.removeChild(t),function(n){if("object"!=typeof n)return n;var r=Object.getPrototypeOf(n).fillText;return"function"!=typeof r||(n.fillText=function(){var t=arguments[2];if("number"==typeof t){var e=n.font.match(/(\d+)(?:\.\d?)?px/i);if(e&&e[1]){var i=o[e[1]];i&&(arguments[2]=t-i)}}return r.apply(this,arguments)}),n}}()});function N(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?N(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function $(t,e){var s={bools:{},strings:{},unknownFn:null};"function"==typeof(e=e||{}).unknown&&(s.unknownFn=e.unknown),"boolean"==typeof e.boolean&&e.boolean?s.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(t){s.bools[t]=!0});var a={};Object.keys(e.alias||{}).forEach(function(t){a[t]=[].concat(e.alias[t]),a[t].forEach(function(e){a[e]=[t].concat(a[t].filter(function(t){return e!==t}))})}),[].concat(e.string).filter(Boolean).forEach(function(t){s.strings[t]=!0,a[t]&&(s.strings[a[t]]=!0)});var r=e.default||{},c={_:[]};Object.keys(s.bools).forEach(function(t){n(t,void 0!==r[t]&&r[t])});var i=[];function n(t,e,i){if(!i||!s.unknownFn||(n=t,r=i,s.allBools&&/^--[^=]+$/.test(r)||s.strings[n]||s.bools[n]||a[n])||!1!==s.unknownFn(i)){var n,r,o=!s.strings[t]&&J(e)?Number(e):e;u(c,t.split("."),o),(a[t]||[]).forEach(function(t){u(c,t.split("."),o)})}}function u(t,e,i){for(var n=t,r=0;r<e.length-1;r++){if("__proto__"===(o=e[r]))return;void 0===n[o]&&(n[o]={}),n[o]!==Object.prototype&&n[o]!==Number.prototype&&n[o]!==String.prototype||(n[o]={}),n[o]===Array.prototype&&(n[o]=[]),n=n[o]}var o;"__proto__"!==(o=e[e.length-1])&&(n!==Object.prototype&&n!==Number.prototype&&n!==String.prototype||(n={}),n===Array.prototype&&(n=[]),void 0===n[o]||s.bools[o]||"boolean"==typeof n[o]?n[o]=i:Array.isArray(n[o])?n[o].push(i):n[o]=[n[o],i])}function o(t){return a[t].some(function(t){return s.bools[t]})}-1!==t.indexOf("--")&&(i=t.slice(t.indexOf("--")+1),t=t.slice(0,t.indexOf("--")));for(var l=0;l<t.length;l++){var h=t[l];if(/^--.+=/.test(h)){var d=h.match(/^--([^=]+)=([\s\S]*)$/),f=d[1],p=d[2];s.bools[f]&&(p="false"!==p),n(f,p,h)}else if(/^--no-.+/.test(h)){n(f=h.match(/^--no-(.+)/)[1],!1,h)}else if(/^--.+/.test(h)){f=h.match(/^--(.+)/)[1];void 0===(b=t[l+1])||/^-/.test(b)||s.bools[f]||s.allBools||a[f]&&o(f)?/^(true|false)$/.test(b)?(n(f,"true"===b,h),l++):n(f,!s.strings[f]||"",h):(n(f,b,h),l++)}else if(/^-[^-]+/.test(h)){for(var g=h.slice(1,-1).split(""),m=!1,v=0;v<g.length;v++){var b;if("-"!==(b=h.slice(v+2))){if(/[A-Za-z]/.test(g[v])&&/=/.test(b)){n(g[v],b.split("=")[1],h),m=!0;break}if(/[A-Za-z]/.test(g[v])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(b)){n(g[v],b,h),m=!0;break}if(g[v+1]&&g[v+1].match(/\W/)){n(g[v],h.slice(v+2),h),m=!0;break}n(g[v],!s.strings[g[v]]||"",h)}else n(g[v],b,h)}f=h.slice(-1)[0];m||"-"===f||(!t[l+1]||/^(-|--)[^-]/.test(t[l+1])||s.bools[f]||a[f]&&o(f)?t[l+1]&&/^(true|false)$/.test(t[l+1])?(n(f,"true"===t[l+1],h),l++):n(f,!s.strings[f]||"",h):(n(f,t[l+1],h),l++))}else if(s.unknownFn&&!1===s.unknownFn(h)||c._.push(s.strings._||!J(h)?h:Number(h)),e.stopEarly){c._.push.apply(c._,t.slice(l+1));break}}return Object.keys(r).forEach(function(e){var t,i,n;t=c,i=e.split("."),n=t,i.slice(0,-1).forEach(function(t){n=n[t]||{}}),i[i.length-1]in n||(u(c,e.split("."),r[e]),(a[e]||[]).forEach(function(t){u(c,t.split("."),r[e])}))}),e["--"]?(c["--"]=new Array,i.forEach(function(t){c["--"].push(t)})):i.forEach(function(t){c._.push(t)}),c}var Y=function(){function o(i){H(this,o);var t=(this.term=i).options,e=t.pixelRatio,n=t.fontSize,r=this.term.template.$canvas;this.scrollTop=0,this.scrollHeight=0,this.lineGap=10*e,this.fontSize=n*e,this.lineHeight=this.lineGap+this.fontSize,this.controlSize=6*e,this.controlColor=["#FF5F56","#FFBD2E","#27C93F"],this.renderIndex=-1,this.$watermark=null,this.$tmp=document.createElement("div"),this.ctx=M(r.getContext("2d")),this.contentPadding=[45,15,15,15].map(function(t){return t*e}),this.cacheEmits=[],this.cacheLogs=[],this.renderLogs=[],this.emit=this.emit.bind(this),this.clear=this.clear.bind(this),this.init(),this.cursor=!1,function t(){var e=this;setTimeout(function(){i.isDestroy||(e.cursor=!e.cursor,e.renderCursor(),t.call(e))},500)}.call(this)}return a(o,[{key:"init",value:function(){var t=this.term,e=t.template.$canvas,i=t.options,n=i.pixelRatio,r=i.fontFamily;this.canvasHeight=e.height,this.canvasWidth=e.width,this.contentHeight=this.canvasHeight-this.contentPadding[0]-this.contentPadding[2],this.contentWidth=this.canvasWidth-this.contentPadding[3]-this.contentPadding[1]/2,this.maxLength=Math.floor(this.contentHeight/this.lineHeight),this.ctx.textBaseline="top",this.ctx.font="".concat(this.fontSize,"px ").concat(r),this.term.emit("size",{header:this.contentPadding[0]/n,content:this.contentHeight/n,footer:this.contentPadding[2]/n}),this.loadWatermark(),this.render()}},{key:"render",value:function(t){var e=!(0<arguments.length&&void 0!==t)||t;return this.term.isDestroy||(this.renderBackground(),this.renderTopbar(),this.renderContent(),e&&this.autoScroll(),this.term.emit("render")),this}},{key:"renderBackground",value:function(){var t=this.term.options,e=t.backgroundColor,i=t.pixelRatio;if(this.ctx.fillStyle=e,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.$watermark){var n=this.$watermark,r=n.width/i,o=n.height/i,s=this.canvasWidth-r,a=this.canvasHeight-o;this.ctx.drawImage(this.$watermark,s,a,r,o)}}},{key:"loadWatermark",value:function(){var t=this,e=this.term.options.watermark;if(e&&(!this.$watermark||this.$watermark.src!==e)){var i=new Image;i.onload=function(){t.$watermark=i,t.render(!1)},i.src=e}}},{key:"renderTopbar",value:function(){var r=this,t=this.term.options,e=t.title,i=t.fontColor,n=t.pixelRatio;this.ctx.fillStyle=i;var o=this.ctx.measureText(e).width;this.ctx.fillText(e,this.canvasWidth/2-o/2,this.contentPadding[1]-n/3),this.controlColor.forEach(function(t,e){r.ctx.beginPath();var i=r.contentPadding[3]+e*r.controlSize*3.6+r.controlSize,n=r.contentPadding[1]+r.controlSize;r.ctx.arc(i,n,r.controlSize,0,360,!1),r.ctx.fillStyle=t,r.ctx.fill(),r.ctx.closePath()})}},{key:"renderContent",value:function(){var t=this.term.options,e=t.pixelRatio,i=t.fontColor;if(this.renderLogs.length)for(var n=0;n<this.renderLogs.length;n+=1){var r=this.renderLogs[n];if(r&&r.length)for(var o=0;o<r.length;o+=1){var s=r[o],a=this.contentPadding[0]+this.lineHeight*n;s.top=a,s.background&&(this.ctx.fillStyle=s.background,this.ctx.fillRect(s.left,a,s.width,this.fontSize)),this.ctx.fillStyle=s.color||i,this.ctx.fillText(s.text,s.left,a),(s.href||s.underline)&&this.ctx.fillRect(s.left,a+this.fontSize,s.width,e),s.del&&this.ctx.fillRect(s.left,a+Math.ceil(this.fontSize/2),s.width,e),s.border&&(this.ctx.fillRect(s.left,a,s.width,e),this.ctx.fillRect(s.left,a+this.fontSize-e,s.width,e),this.ctx.fillRect(s.left,a,e,this.fontSize),this.ctx.fillRect(s.left+s.width-e,a,e,this.fontSize))}}if(this.renderEditable){var c=this.cursorPos,u=c.left,l=c.top;this.term.emit("cursor",{left:u/e,top:l/e})}this.scrollHeight=this.cacheLogs.length*this.lineHeight/e,this.term.emit("scrollHeight",this.scrollHeight)}},{key:"autoScroll",value:function(){var t=this.term.options.pixelRatio,e=this.renderLogs[this.renderLogs.length-1],i=this.cacheLogs.indexOf(e);this.scrollTop=((i+1)*this.lineHeight-this.contentHeight)/t,this.term.emit("scrollTop",this.scrollTop)}},{key:"renderByIndex",value:function(t){this.renderIndex!==t&&(this.renderIndex=t,this.renderLogs=this.cacheLogs.slice(t,t+this.maxLength),this.render(!1))}},{key:"renderByTop",value:function(t){var e=this.term.options.pixelRatio,i=Math.ceil(t*e/this.lineHeight);this.renderByIndex(i)}},{key:"renderCursor",value:function(){var t=this.term.options,e=t.backgroundColor,i=t.fontColor,n=t.pixelRatio,r=this.cursorPos,o=r.left,s=r.top;this.renderEditable&&o&&s&&(this.ctx.fillStyle=this.cursor?i:e,this.ctx.fillRect(o,s,5*n,this.fontSize))}},{key:"emit",value:function(t){var e;if(f(t,{type:function(t){return!![F,S].includes(t)||'The type must be "'.concat(F,'" or "').concat(S,'"')},text:"string",prefix:"undefined|string",replace:"undefined|boolean"}),t.replace){this.cacheEmits.pop();var i=this.cacheLogs[this.cacheLogs.length-1];i&&i.group&&(this.cacheLogs=this.cacheLogs.filter(function(t){return t.group!==i.group}))}this.cacheEmits.push(Z({},t));var n=this.parse(t);(e=this.cacheLogs).push.apply(e,V(n)),this.renderLogs=this.cacheLogs.slice(-this.maxLength),this.render()}},{key:"parse",value:function(t){var e=this.term.options.prefix;t.type===F&&(t.text=(t.prefix||e)+O(t.text));for(var i=L(),n=[],r=t.text.split(/\r?\n/),o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=0,a=this.contentPadding[3],c=0;c<r.length;c+=1){var u=r[c];this.$tmp.innerHTML=u.replace(o,"");for(var l=0;l<this.$tmp.childNodes.length;l+=1){var h=this.$tmp.childNodes[l],d=h.textContent,f=this.ctx.measureText(d).width,p={};h.tagName&&(p.color=h.getAttribute("color"),p.background=h.getAttribute("background"),p.href=h.getAttribute("href"),p.border=h.hasAttribute("border"),p.underline=h.hasAttribute("underline"),p.del=h.hasAttribute("del"));var g=a+f;if(g>this.contentWidth){for(var m="",v=!1,b=a,y=V(d),x=0;x<y.length;x+=1){var w=y[x],C=this.ctx.measureText(w).width,I=a+C;if(I<=this.contentWidth)m+=w,a=I;else{var k=Z({},t,{},p,{width:this.ctx.measureText(m).width,left:v?this.contentPadding[3]:b,text:m});n[s]?n[s].push(k):(n[s]=[k],n[s].group=i),s+=1,m=w,v=!0,a=this.contentPadding[3]+C}}var E=Z({},t,{},p,{width:this.ctx.measureText(m).width,left:this.contentPadding[3],text:m});n[s]?n[s].push(E):(n[s]=[E],n[s].group=i)}else{var A=Z({},t,{},p,{width:f,left:a,text:d});n[s]?n[s].push(A):(n[s]=[A],n[s].group=i),a=g}}s+=1,a=this.contentPadding[3]}return n.filter(Boolean)}},{key:"clear",value:function(){this.cacheEmits=[],this.cacheLogs=[],this.renderLogs=[],this.render()}},{key:"lastCacheLog",get:function(){var t=this.cacheLogs[this.cacheLogs.length-1];return t&&t[t.length-1]}},{key:"lastRenderLog",get:function(){var t=this.renderLogs[this.renderLogs.length-1];return t&&t[t.length-1]}},{key:"cacheEditable",get:function(){return this.term.isFocus&&this.lastCacheLog&&this.lastCacheLog.type===F}},{key:"renderEditable",get:function(){return this.cacheEditable&&this.lastCacheLog===this.lastRenderLog}},{key:"cursorPos",get:function(){if(this.renderEditable){var t=this.term.options.pixelRatio;return{left:this.lastRenderLog.left+this.lastRenderLog.width+4*t,top:this.contentPadding[0]+this.lineHeight*(this.renderLogs.length-1)}}return{left:0,top:0}}}]),o}();function J(t){return"number"==typeof t||(/^0x[0-9a-f]+$/i.test(t)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t))}var q=function(){function r(t){var e=this;H(this,r);var i=(this.term=t).drawer,n=t.options.welcome;this.isTyping=!1,this.typeTimer=null,this.askResolve=null,this.type=this.type.bind(this),this.input=this.input.bind(this),this.output=this.output.bind(this),this.ask=function(t){return k(!e.isQuestion,"The last problem has not been solved"),e.question(t)},this.output(n).input(),t.on("input",function(t){i.cacheEditable&&(e.isQuestion?e.question(i.lastCacheLog.prefix,t):e.input(t,!0))}),t.on("enter",function(t){i.cacheEditable&&t.trim()&&(e.isQuestion?(e.askResolve(t),e.askResolve=null):e.execute(t))}),t.on("abort",function(){e.stopType()})}return a(r,[{key:"execute",value:function(t){var n=this,e=0<arguments.length&&void 0!==t?t:"";if(!e.trim())return this.input();var i=this.term.options,r=i.parseOpt,o=i.notFound,s=i.loading,a=this.findAction(e),c=$(e.split(" "),r);if(!a){var u=o.call(this.term,e,c);return this.output(u).input()}if("function"!=typeof a.output)return this.output(a.output).input();try{var l=a.output.call(this.term,e,c);if("promise"!==f.kindOf(l))return void 0!==l?this.output(l).input():this;var h=s.call(this.term,e,c);return this.output(h),l.then(function(t){return void 0!==t?n.output(t,!0).input():n}).catch(function(t){var e="error"===f.kindOf(t)?"".concat(String(t)):"Error: ".concat(String(t)),i='<d color="red">'.concat(e,"</d>");return n.output(i,!0).input()})}catch(t){var d='<d color="red">'.concat(String(t),"</d>");return this.output(d).input()}}},{key:"findAction",value:function(i){return i=i.trim().toLowerCase(),this.term.options.actions.find(function(t){var e=f.kindOf(t.input);return"string"===e?i===t.input:"regexp"===e?t.input.test(i):null})}},{key:"output",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:"",n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:S,replace:n,text:String(i)}),this}},{key:"input",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:"",n=1<arguments.length&&void 0!==e&&e;return this.term.drawer.emit({type:F,replace:n,text:String(i)}),this}},{key:"question",value:function(t,e){var i=this,n=0<arguments.length&&void 0!==t?t:"",r=1<arguments.length&&void 0!==e?e:"";return this.isQuestion?this.term.drawer.emit({type:F,replace:!0,prefix:n,text:r}):new Promise(function(t){i.askResolve=t,i.term.drawer.emit({type:F,replace:!1,prefix:n,text:r})})}},{key:"type",value:function(t,e){var i=this,s=0<arguments.length&&void 0!==t?t:"",a=!(1<arguments.length&&void 0!==e)||e;if(this.isTyping)return Promise.reject();var c=this.term.template.$textarea;return new Promise(function(n){var r=V(s),o="";(function t(){var e=this;if(r.length){this.isTyping=!0;var i=r.shift();o+=i,this.input(o,!0),this.typeTimer=setTimeout(function(){e.term.isDestroy||t.call(e)},100)}else this.isTyping=!1,c.value=o,a&&(this.execute(o),c.value=""),n(o)}).call(i)})}},{key:"stopType",value:function(){clearTimeout(this.typeTimer)}},{key:"isQuestion",get:function(){var t=this.term.drawer,e=t.lastCacheLog;return t.cacheEditable&&e.prefix&&"function"==typeof this.askResolve}}]),r}(),K=function(){function e(t){H(this,e),this.term=t,this.blobs=[]}return a(e,[{key:"start",value:function(){var e=this;k(!this.recording,"The recorder is recording...");var t=this.term.template.$canvas;this.stream=t.captureStream(30),k(this.stream,"Cannot get MediaStream of canvas"),k(MediaRecorder&&MediaRecorder.isTypeSupported(U.mimeType),"Does not support recording webm video"),this.recorder=new MediaRecorder(this.stream,U),this.recorder.ondataavailable=function(t){e.recording&&t.data&&0<t.data.size&&(e.blobs.push(t.data),e.term.emit("recording",{size:e.size,duration:e.duration}))},this.recorder.onstart=function(){e.term.emit("start")},this.recorder.onstop=function(){var t=URL.createObjectURL(new Blob(e.blobs));E(t,"".concat(Date.now(),".webm")),URL.revokeObjectURL(t),e.blobs=[],e.term.emit("end")},this.recorder.start(1e3)}},{key:"end",value:function(){this.term.emit("creating"),this.recorder.stop()}},{key:"recording",get:function(){return this.recorder&&"recording"===this.recorder.state}},{key:"size",get:function(){return this.blobs.reduce(function(t,e){return t+e.size},0)}},{key:"duration",get:function(){return this.blobs.length}}]),e}(),tt=t(function(C,t){!function(t,P,e,V){function i(){}var n,r,M={URL:t.URL||t.webkitURL||t.mozURL||t.msURL,getUserMedia:(r=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia)?r.bind(e):r,requestAnimFrame:t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame,requestTimeout:function(i,n){if(i=i||M.noop,n=n||0,!M.requestAnimFrame)return setTimeout(i,n);var r=(new Date).getTime(),o=new Object,s=M.requestAnimFrame;return o.value=s(function t(){var e=(new Date).getTime();n<=e-r?i.call():o.value=s(t)}),o},Blob:t.Blob||t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,btoa:(n=t.btoa||function(t){for(var e="",i=0,n=t.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,s=void 0,a=void 0,c=void 0,u=void 0,l=void 0,h=void 0;i<n;)c=(o=t.charCodeAt(i++))>>2,u=(3&o)<<4|(s=t.charCodeAt(i++))>>4,l=(15&s)<<2|(a=t.charCodeAt(i++))>>6,h=63&a,isNaN(s)?l=h=64:isNaN(a)&&(h=64),e=e+r.charAt(c)+r.charAt(u)+r.charAt(l)+r.charAt(h);return e})?n.bind(t):M.noop,isObject:function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){return M.isObject(t)&&!Object.keys(t).length},isArray:function(t){return t&&Array.isArray(t)},isFunction:function(t){return t&&"function"==typeof t},isElement:function(t){return t&&1===t.nodeType},isString:function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},isSupported:{canvas:function(){var t=P.createElement("canvas");return t&&t.getContext&&t.getContext("2d")},webworkers:function(){return t.Worker},blob:function(){return M.Blob},Uint8Array:function(){return t.Uint8Array},Uint32Array:function(){return t.Uint32Array},videoCodecs:function(){var t=P.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=""!==t.canPlayType('video/mp4; codecs="mp4v.20.8"'),e.h264=""!==(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),e.ogv=""!==t.canPlayType('video/ogg; codecs="theora"'),e.ogg=""!==t.canPlayType('video/ogg; codecs="theora"'),e.webm=-1!==t.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(t){}return e}()},noop:function(){},each:function(t,e){var i=void 0,n=void 0;if(M.isArray(t))for(i=-1,n=t.length;++i<n&&!1!==e(i,t[i]););else if(M.isObject(t))for(i in t)if(t.hasOwnProperty(i)&&!1===e(i,t[i]))break},mergeOptions:function(n,r){if(M.isObject(n)&&M.isObject(r)&&Object.keys){var o={};return M.each(n,function(t,e){o[t]=n[t]}),M.each(r,function(t,e){var i=r[t];M.isObject(i)&&n[t]?o[t]=M.mergeOptions(n[t],i):o[t]=i}),o}},setCSSAttr:function(i,t,e){M.isElement(i)&&(M.isString(t)&&M.isString(e)?i.style[t]=e:M.isObject(t)&&M.each(t,function(t,e){i.style[t]=e}))},removeElement:function(t){M.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},createWebWorker:function(t){if(!M.isString(t))return{};try{var e=new M.Blob([t],{type:"text/javascript"}),i=M.URL.createObjectURL(e);return{objectUrl:i,worker:new Worker(i)}}catch(t){return""+t}},getExtension:function(t){return t.substr(t.lastIndexOf(".")+1,t.length)},getFontSize:function(t){var e=0<arguments.length&&t!==V?t:{};if(!P.body||!1===e.resizeFont)return e.fontSize;var i=e.text,n=e.gifWidth,r=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),s=P.createElement("div"),a=P.createElement("span");for(s.setAttribute("width",n),s.appendChild(a),a.innerHTML=i,a.style.fontSize=r+"px",a.style.textIndent="-9999px",a.style.visibility="hidden",P.body.appendChild(a);a.offsetWidth>n&&o<=r;)a.style.fontSize=--r+"px";return P.body.removeChild(a),r+"px"},webWorkerError:!1},o=Object.freeze({default:M}),d={validate:function(n){n=M.isObject(n)?n:{};var r={};return M.each(d.validators,function(t,e){var i=e.errorCode;if(!n[i]&&!e.condition)return!((r=e).error=!0)}),delete r.condition,r},isValid:function(t){var e=!0!==d.validate(t).error;return e},validators:[{condition:M.isFunction(M.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:M.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:M.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:M.isFunction(M.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:M.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:M.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:M.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},s=Object.freeze({default:d}),c={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:i,completeCallback:i,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},a=Object.freeze({default:c});function u(){return d.isValid()}function g(){var p,g,m,v,f,b=256,y=499,x=491,w=487,C=503,I=3*C,c=b-1,k=4,E=100,A=16,o=1<<A,L=10,O=10,F=o>>O,S=o<<L-O,Q=6,D=(b>>3)*(1<<Q),U=30,B=1024,R=256,d=1<<18,l=[],W=[],G=[],T=[];function j(t,e,i,n,r){var o,s,a,c,u,l,h;for((a=e-t)<-1&&(a=-1),b<(c=e+t)&&(c=b),o=e+1,s=e-1,l=1;o<c||a<s;){if(u=T[l++],o<c){h=f[o++];try{h[0]-=u*(h[0]-i)/d|0,h[1]-=u*(h[1]-n)/d|0,h[2]-=u*(h[2]-r)/d|0}catch(t){}}if(a<s){h=f[s--];try{h[0]-=u*(h[0]-i)/d|0,h[1]-=u*(h[1]-n)/d|0,h[2]-=u*(h[2]-r)/d|0}catch(t){}}}}function P(t,e,i,n,r){var o=f[e],s=t/B;o[0]-=s*(o[0]-i)|0,o[1]-=s*(o[1]-n)|0,o[2]-=s*(o[2]-r)|0}function V(t,e,i){var n,r,o,s,a,c,u,l,h,d;for(h=l=~(1<<31),u=c=-1,n=0;n<b;n++)(r=(d=f[n])[0]-t)<0&&(r=-r),(o=d[1]-e)<0&&(o=-o),r+=o,(o=d[2]-i)<0&&(o=-o),(r+=o)<l&&(l=r,c=n),(s=r-(W[n]>>A-k))<h&&(h=s,u=n),a=G[n]>>O,G[n]-=a,W[n]+=a<<L;return G[c]+=F,W[c]-=S,u}(function(t,e,i){var n,r;for(g=t,m=e,v=i,f=new Array(b),n=0;n<b;n++)f[n]=new Array(4),(r=f[n])[0]=r[1]=r[2]=(n<<k+8)/b|0,G[n]=o/b|0,W[n]=0}).apply(this,arguments);var t={map:function(t,e,i){var n,r,o,s,a,c,u;for(a=1e3,u=-1,r=(n=l[e])-1;n<b||0<=r;)n<b&&(a<=(o=(c=f[n])[1]-e)?n=b:(n++,o<0&&(o=-o),(s=c[0]-t)<0&&(s=-s),(o+=s)<a&&((s=c[2]-i)<0&&(s=-s),(o+=s)<a&&(a=o,u=c[3])))),0<=r&&(a<=(o=e-(c=f[r])[1])?r=-1:(r--,o<0&&(o=-o),(s=c[0]-t)<0&&(s=-s),(o+=s)<a&&((s=c[2]-i)<0&&(s=-s),(o+=s)<a&&(a=o,u=c[3]))));return u}};return t.process=function(){return function(){var t,e,i,n,r,o,s,a,c,u,l,h,d,f;for(m<I&&(v=1),p=30+(v-1)/3,h=g,u=(l=(f=m)/(3*v))/E|(d=0),a=B,(s=(o=D)>>Q)<=1&&(s=0),t=0;t<s;t++)T[t]=a*((s*s-t*t)*R/(s*s));for(c=m<I?3:m%y!=0?3*y:m%x!=0?3*x:m%w!=0?3*w:3*C,t=0;t<l;)if(P(a,e=V(i=(255&h[d+0])<<k,n=(255&h[d+1])<<k,r=(255&h[d+2])<<k),i,n,r),0!==s&&j(s,e,i,n,r),f<=(d+=c)&&(d-=m),0===u&&(u=1),++t%u==0)for(a-=a/p,(s=(o-=o/U)>>Q)<=1&&(s=0),e=0;e<s;e++)T[e]=a*((s*s-e*e)*R/(s*s))}(),function(){var t;for(t=0;t<b;t++)f[t][0]>>=k,f[t][1]>>=k,f[t][2]>>=k,f[t][3]=t}(),function(){var t,e,i,n,r,o,s,a;for(t=a=s=0;t<b;t++){for(n=(r=f[i=t])[1],e=t+1;e<b;e++)(o=f[e])[1]<n&&(i=e,n=o[1]);if(o=f[i],t!=i&&(e=o[0],o[0]=r[0],r[0]=e,e=o[1],o[1]=r[1],r[1]=e,e=o[2],o[2]=r[2],r[2]=e,e=o[3],o[3]=r[3],r[3]=e),n!=s){for(l[s]=a+t>>1,e=s+1;e<n;e++)l[e]=t;s=n,a=t}}for(l[s]=a+c>>1,e=s+1;e<256;e++)l[e]=c}(),function(){for(var t=[],e=new Array(b),i=0;i<b;i++)e[f[i][3]]=i;for(var n=0,r=0;r<b;r++){var o=e[r];t[n++]=f[o][0],t[n++]=f[o][1],t[n++]=f[o][2]}return t}()},t}function l(){try{this.onmessage=function(t){var e,i=t.data||{};i.gifshot&&(e=n.run(i),postMessage(e))}}catch(t){}var n={dataToRGB:function(t,e,i){for(var n=e*i*4,r=0,o=[];r<n;)o.push(t[r++]),o.push(t[r++]),o.push(t[r++]),r++;return o},componentizedPaletteToArray:function(t){t=t||[];for(var e=[],i=0;i<t.length;i+=3){var n=t[i],r=t[i+1],o=t[i+2];e.push(n<<16|r<<8|o)}return e},processFrameWithQuantizer:function(t,e,i,n){for(var r=this.dataToRGB(t,e,i),o=new g(r,r.length,n),s=o.process(),a=new Uint32Array(this.componentizedPaletteToArray(s)),c=e*i,u=new Uint8Array(c),l=0,h=0;h<c;h++){var d=r[l++],f=r[l++],p=r[l++];u[h]=o.map(d,f,p)}return{pixels:u,palette:a}},run:function(t){t=t||{};var e=t.height,i=(t.palette,t.sampleInterval),n=t.width,r=t.data;return this.processFrameWithQuantizer(r,n,e,i)}};return n}function p(v,t,e,i){var b=0,n=(i=i===V?{}:i).loop===V?null:i.loop,y=i.palette===V?null:i.palette;if(t<=0||e<=0||65535<t||65535<e)throw"Width/Height invalid.";v[b++]=71,v[b++]=73,v[b++]=70,v[b++]=56,v[b++]=57,v[b++]=97;if(v[b++]=255&t,v[b++]=t>>8&255,v[b++]=255&e,v[b++]=e>>8&255,v[b++]=0|(null!==y?128:0),v[b++]=0,v[b++]=0,null!==n){if(n<0||65535<n)throw"Loop count invalid.";v[b++]=33,v[b++]=255,v[b++]=11,v[b++]=78,v[b++]=69,v[b++]=84,v[b++]=83,v[b++]=67,v[b++]=65,v[b++]=80,v[b++]=69,v[b++]=50,v[b++]=46,v[b++]=48,v[b++]=3,v[b++]=1,v[b++]=255&n,v[b++]=n>>8&255,v[b++]=0}var x=!1;this.addFrame=function(t,e,i,n,r,o){if(!0===x&&(--b,x=!1),o=o===V?{}:o,t<0||e<0||65535<t||65535<e)throw"x/y invalid.";if(i<=0||n<=0||65535<i||65535<n)throw"Width/Height invalid.";if(r.length<i*n)throw"Not enough pixels for the frame size.";var s=!0,a=o.palette;if(a!==V&&null!==a||(s=!1,a=y),a===V||null===a)throw"Must supply either a local or global palette.";for(var c=function(t){var e=t.length;if(e<2||256<e||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}(a),u=0;c>>=1;)++u;c=1<<u;var l=o.delay===V?0:o.delay,h=o.disposal===V?0:o.disposal;if(h<0||3<h)throw"Disposal out of range.";var d=!1,f=0;if(o.transparent!==V&&null!==o.transparent&&(d=!0,(f=o.transparent)<0||c<=f))throw"Transparent color index.";if(0===h&&!d&&0===l||(v[b++]=33,v[b++]=249,v[b++]=4,v[b++]=h<<2|(!0===d?1:0),v[b++]=255&l,v[b++]=l>>8&255,v[b++]=f,v[b++]=0),v[b++]=44,v[b++]=255&t,v[b++]=t>>8&255,v[b++]=255&e,v[b++]=e>>8&255,v[b++]=255&i,v[b++]=i>>8&255,v[b++]=255&n,v[b++]=n>>8&255,v[b++]=!0===s?128|u-1:0,!0===s)for(var p=0,g=a.length;p<g;++p){var m=a[p];v[b++]=m>>16&255,v[b++]=m>>8&255,v[b++]=255&m}b=function(e,i,t,n){e[i++]=t;var r=i++,o=1<<t,s=o-1,a=1+o,c=1+a,u=t+1,l=0,h=0;function d(t){for(;t<=l;)e[i++]=255&h,h>>=8,l-=8,i===r+256&&(e[r]=255,r=i++)}function f(t){h|=t<<l,l+=u,d(8)}var p=n[0]&s,g={};f(o);for(var m=1,v=n.length;m<v;++m){var b=n[m]&s,y=p<<8|b,x=g[y];if(x===V){for(h|=p<<l,l+=u;8<=l;)e[i++]=255&h,h>>=8,l-=8,i===r+256&&(e[r]=255,r=i++);4096===c?(f(o),c=1+a,u=t+1,g={}):(1<<u<=c&&++u,g[y]=c++),p=b}else p=x}f(p),f(a),d(1),r+1===i?e[r]=0:(e[r]=i-r-1,e[i++]=0);return i}(v,b,u<2?2:u,r)},this.end=function(){return!1===x&&(v[b++]=59,x=!0),b}}function h(){}var N=function(t){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=h,this.onRenderProgressCallback=h,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=t,this.initializeWebWorkers(t)};function f(t){var e=0<arguments.length&&t!==V?t:{},r=e.callback,i=e.images,o=e.options,s=e.imagesLength,n=d.validate({getUserMedia:!0,"window.URL":!0}),a=[],c=0,u=void 0,l=void 0;if(n.error)return r(n);function h(){var e;M.each(a,function(t,e){e&&(e.text?l.addFrame(e.img,o,e.text):l.addFrame(e,o))}),e=r,l.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t})})}l=new N(o),M.each(i,function(e,i){var n,t=i;i.src&&(t=t.src),M.isElement(t)?(o.crossOrigin&&(t.crossOrigin=o.crossOrigin),a[e]=t,(c+=1)===s&&h()):M.isString(t)&&(u=new Image,o.crossOrigin&&(u.crossOrigin=o.crossOrigin),n=u,i.text&&(n.text=i.text),n.onerror=function(t){if(0===--s)return r({error:"None of the requested images was capable of being retrieved"})},n.onload=function(t){i.text?a[e]={img:n,text:n.text}:a[e]=n,(c+=1)===s&&h(),M.removeElement(n)},n.src=t,M.setCSSAttr(u,{position:"fixed",opacity:"0"}),P.body.appendChild(u))})}N.prototype={workerMethods:l(),initializeWebWorkers:function(t){var e,i=g.toString()+"("+l.toString()+"());",n=void 0,r=void 0,o=void 0,s=-1,a="";for(e=t.numWorkers;++s<e;)n=M.createWebWorker(i),M.isObject(n)?(r=n.objectUrl,o=n.worker,this.workers.push({worker:o,objectUrl:r}),this.availableWorkers.push(o)):(a=n,M.webWorkerError=!!n);this.workerError=a,this.canvas=P.createElement("canvas"),this.canvas.width=t.gifWidth,this.canvas.height=t.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(t){this.availableWorkers.push(t)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(t){for(var e=t.length,i="",n=-1;++n<e;)i+=this.byteMap[t[n]];return i},onFrameFinished:function(t){var e=this,i=e.frames,n=!!(e.options.images||[]).length,r=i.every(function(t){return!t.beingProcessed&&t.done});e.numRenderedFrames++,n&&t(e.numRenderedFrames/i.length),e.onRenderProgressCallback(.75*e.numRenderedFrames/i.length),r?e.generatingGIF||e.generateGIF(i,e.onRenderCompleteCallback):M.requestTimeout(function(){e.processNextFrame()},1)},processFrame:function(t){function e(t){var e=(0<arguments.length&&t!==V?t:{}).data;delete a.data,a.pixels=Array.prototype.slice.call(e.pixels),a.palette=Array.prototype.slice.call(e.palette),a.done=!0,a.beingProcessed=!1,i.freeWorker(c),i.onFrameFinished(r)}var i=this,n=(this.options,this.options),r=n.progressCallback,o=n.sampleInterval,s=this.frames,a=void 0,c=void 0;(a=s[t]).beingProcessed||a.done?this.onFrameFinished():(a.sampleInterval=o,a.beingProcessed=!0,a.gifshot=!0,(c=this.getWorker())?(c.onmessage=e,c.postMessage(a)):e({data:i.workerMethods.run(a)}))},startRendering:function(t){this.onRenderCompleteCallback=t;for(var e=0;e<this.options.numWorkers&&e<this.frames.length;e++)this.processFrame(e)},processNextFrame:function(){for(var t=-1,e=0;e<this.frames.length;e++){var i=this.frames[e];if(!i.done&&!i.beingProcessed){t=e;break}}0<=t&&this.processFrame(t)},generateGIF:function(r,t){var e=[],i={loop:this.repeat},n=this.options,o=n.interval,s=n.frameDuration,a=!!n.images.length,c=n.gifHeight,u=n.gifWidth,l=new p(e,u,c,i),h=this.onRenderProgressCallback,d=a?100*o:0,f=void 0;this.generatingGIF=!0,M.each(r,function(t,e){var i=e.palette;h(.75+.25*e.position*1/r.length);for(var n=0;n<s;n++)l.addFrame(0,0,u,c,e.pixels,{palette:i,delay:d})}),l.end(),h(1),this.frames=[],this.generatingGIF=!1,M.isFunction(t)&&(f=this.bufferToString(e),t("data:image/gif;base64,"+M.btoa(f)))},setRepeat:function(t){this.repeat=t},addFrame:function(t,e){e=M.isObject(e)?e:{};var i=this.ctx,n=this.options,r=n.gifWidth,o=n.gifHeight,s=M.getFontSize(e),a=e.filter,c=e.fontColor,u=e.fontFamily,l=e.fontWeight,h=(e.gifHeight,e.gifWidth,e.text),d=e.textAlign,f=e.textBaseline,p=e.textXCoordinate?e.textXCoordinate:"left"===d?1:"right"===d?r:r/2,g=e.textYCoordinate?e.textYCoordinate:"top"===f?1:"center"===f?o/2:o,m=l+" "+s+" "+u,v=void 0;try{i.filter=a,i.drawImage(t,0,0,r,o),h&&(i.font=m,i.fillStyle=c,i.textAlign=d,i.textBaseline=f,i.fillText(h,p,g)),v=i.getImageData(0,0,r,o),this.addFrameImageData(v)}catch(t){return""+t}},addFrameImageData:function(t){var e=0<arguments.length&&t!==V?t:{},i=this.frames,n=e.data;this.frames.push({data:n,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:i.length})},onRenderProgress:function(t){this.onRenderProgressCallback=t},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var i=this;i.startRendering(function(t){i.destroyWorkers(),M.requestTimeout(function(){e(t)},0)})},destroyWorkers:function(){if(!this.workerError){var t=this.workers;M.each(t,function(t,e){var i=e.worker,n=e.objectUrl;i.terminate(),M.URL.revokeObjectURL(n)})}}};function H(){}var m={getGIF:function(t,e){var i=0<arguments.length&&t!==V?t:{},n=e;n=M.isFunction(n)?n:H;var r=P.createElement("canvas"),o=void 0,s=!!i.images.length,a=i.cameraStream,c=i.crop,u=i.filter,l=i.fontColor,h=i.fontFamily,d=i.fontWeight,f=i.keepCameraOn,p=(i.numWorkers,i.progressCallback),g=i.saveRenderingContexts,m=i.savedRenderingContexts,v=i.text,b=i.textAlign,y=i.textBaseline,x=i.videoElement,w=i.videoHeight,C=i.videoWidth,I=i.webcamVideoElement,k=Number(i.gifWidth),E=Number(i.gifHeight),A=Number(i.interval),L=(Number(i.sampleInterval),s?0:1e3*A),O=[],F=m.length?m.length:i.numFrames,S=F,Q=new N(i),D=M.getFontSize(i),U=i.textXCoordinate?i.textXCoordinate:"left"===b?1:"right"===b?k:k/2,B=i.textYCoordinate?i.textYCoordinate:"top"===y?1:"center"===y?E/2:E,R=d+" "+D+" "+h,W=c?Math.floor(c.scaledWidth/2):0,G=c?C-c.scaledWidth:0,T=c?Math.floor(c.scaledHeight/2):0,j=c?w-c.scaledHeight:0;F=F!==V?F:10,A=A!==V?A:.1,r.width=k,r.height=E,o=r.getContext("2d"),function t(){m.length||0!==x.currentTime?function e(){var i=S-1;function t(){var t;g&&O.push(o.getImageData(0,0,k,E)),v&&(o.font=R,o.fillStyle=l,o.textAlign=b,o.textBaseline=y,o.fillText(v,U,B)),t=o.getImageData(0,0,k,E),Q.addFrameImageData(t),p((F-(S=i))/F),0<i&&M.requestTimeout(e,L),S||Q.getBase64GIF(function(t){n({error:!1,errorCode:"",errorMsg:"",image:t,cameraStream:a,videoElement:x,webcamVideoElement:I,savedRenderingContexts:O,keepCameraOn:f})})}m.length?(o.putImageData(m[F-S],0,0),t()):function e(){try{C<G&&(G=C),w<j&&(j=w),W<0&&(W=0),T<0&&(T=0),o.filter=u,o.drawImage(x,W,T,G,j,0,0,k,E),t()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;M.requestTimeout(e,100)}}()}():M.requestTimeout(t,100)}()},getCropDimensions:function(t){var e=0<arguments.length&&t!==V?t:{},i=e.videoWidth,n=e.videoHeight,r=e.gifWidth,o=e.gifHeight,s={width:0,height:0,scaledWidth:0,scaledHeight:0};return n<i?(s.width=Math.round(i*(o/n))-r,s.scaledWidth=Math.round(s.width*(n/o))):(s.height=Math.round(n*(r/i))-o,s.scaledHeight=Math.round(s.height*(i/r))),s}},v={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var i=e.cameraStream,n=e.completedCallback,r=e.videoElement;r&&(0<r.videoWidth&&0<r.videoHeight?(r.removeEventListener("loadeddata",v.findVideoSize),n({videoElement:r,cameraStream:i,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):t.attempts<10?(t.attempts+=1,M.requestTimeout(function(){v.findVideoSize(e)},400)):n({videoElement:r,cameraStream:i,videoWidth:v.defaultVideoDimensions.width,videoHeight:v.defaultVideoDimensions.height}))},onStreamingTimeout:function(t){M.isFunction(t)&&t({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(t){var e=M.isArray(t.existingVideo)?t.existingVideo[0]:t.existingVideo,i=t.cameraStream,n=t.completedCallback,r=t.streamedCallback,o=t.videoElement;if(M.isFunction(r)&&r(),e){if(M.isString(e))o.src=e,o.innerHTML='<source src="'+e+'" type="video/'+M.getExtension(e)+'" />';else if(e instanceof Blob){try{o.src=M.URL.createObjectURL(e)}catch(t){}o.innerHTML='<source src="'+e+'" type="'+e.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=i;else if(M.URL)try{o.srcObject=i,o.src=M.URL.createObjectURL(i)}catch(t){o.srcObject=i}o.play(),M.requestTimeout(function t(){t.count=t.count||0,!0===v.loadedData?(v.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}),v.loadedData=!1):10<(t.count+=1)?v.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}):t()},0)},startStreaming:function(t){var e=M.isFunction(t.error)?t.error:M.noop,i=M.isFunction(t.streamed)?t.streamed:M.noop,n=M.isFunction(t.completed)?t.completed:M.noop,r=t.crossOrigin,o=t.existingVideo,s=t.lastCameraStream,a=t.options,c=t.webcamVideoElement,u=M.isElement(o)?o:c||P.createElement("video");r&&(u.crossOrigin=a.crossOrigin),u.autoplay=!0,u.loop=!0,u.muted=!0,u.addEventListener("loadeddata",function(t){v.loadedData=!0,a.offset&&(u.currentTime=a.offset)}),o?v.stream({videoElement:u,existingVideo:o,completedCallback:n}):s?v.stream({videoElement:u,cameraStream:s,streamedCallback:i,completedCallback:n}):M.getUserMedia({video:!0},function(t){v.stream({videoElement:u,cameraStream:t,streamedCallback:i,completedCallback:n})},e)},startVideoStreaming:function(s,t){var e=1<arguments.length&&t!==V?t:{},i=e.timeout!==V?e.timeout:0,n=e.callback,r=e.webcamVideoElement,o=void 0;0<i&&(o=M.requestTimeout(function(){v.onStreamingTimeout(n)},1e4)),v.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(o)},completed:function(t){var e=0<arguments.length&&t!==V?t:{},i=e.cameraStream,n=e.videoElement,r=e.videoHeight,o=e.videoWidth;s({cameraStream:i,videoElement:n,videoHeight:r,videoWidth:o})},lastCameraStream:e.lastCameraStream,webcamVideoElement:r,crossOrigin:e.crossOrigin,options:e})},stopVideoStreaming:function(t){t=M.isObject(t)?t:{};var e=t.keepCameraOn,i=t.videoElement,n=t.webcamVideoElement,r=t.cameraStream||{},o=r.getTracks&&r.getTracks()||[],s=o[0];!e&&o.length&&M.isFunction(s.stop)&&s.stop(),M.isElement(i)&&!n&&(i.pause(),M.isFunction(M.URL.revokeObjectURL)&&!M.webWorkerError&&i.src&&M.URL.revokeObjectURL(i.src),M.removeElement(i))}};function b(t){t=M.isObject(t)?t:{},v.stopVideoStreaming(t)}function y(t,e){var i=t.options||{},n=i.images,r=i.video,o=Number(i.gifWidth),s=Number(i.gifHeight),a=(Number(i.numFrames),t.cameraStream),c=t.videoElement,u=t.videoWidth,l=t.videoHeight,h=m.getCropDimensions({videoWidth:u,videoHeight:l,gifHeight:s,gifWidth:o}),d=e;i.crop=h,i.videoElement=c,i.videoWidth=u,i.videoHeight=l,i.cameraStream=a,M.isElement(c)&&(c.width=o+h.width,c.height=s+h.height,i.webcamVideoElement||(M.setCSSAttr(c,{position:"fixed",opacity:"0"}),P.body.appendChild(c)),c.play(),m.getGIF(i,function(t){n&&n.length||r&&r.length||b(t),d(t)}))}function x(t,e){if(e=M.isFunction(t)?t:e,t=M.isObject(t)?t:{},M.isFunction(e)){var i=M.mergeOptions(c,t)||{},n=t.cameraStream,r=i.images,o=r?r.length:0,s=i.video,a=i.webcamVideoElement;i=M.mergeOptions(i,{gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),o?f({images:r,imagesLength:o,callback:e,options:i}):s?function(t){var e=0<arguments.length&&t!==V?t:{},i=e.callback,n=e.existingVideo,r=e.options,o=d.validate({getUserMedia:!0,"window.URL":!0}),s=void 0,a=void 0;if(o.error)return i(o);if(M.isElement(n)&&n.src){if(a=n.src,s=M.getExtension(a),!M.isSupported.videoCodecs[s])return i(d.messages.videoCodecs)}else M.isArray(n)&&M.each(n,function(t,e){if(s=e instanceof Blob?e.type.substr(e.type.lastIndexOf("/")+1,e.length):e.substr(e.lastIndexOf(".")+1,e.length),M.isSupported.videoCodecs[s])return n=e,!1});v.startStreaming({completed:function(t){t.options=r||{},y(t,i)},existingVideo:n,crossOrigin:r.crossOrigin,options:r})}({existingVideo:s,callback:e,options:i}):function(t){var e=0<arguments.length&&t!==V?t:{},i=e.callback,n=e.lastCameraStream,r=e.options,o=e.webcamVideoElement;if(!u())return i(d.validate());r.savedRenderingContexts.length?m.getGIF(r,function(t){i(t)}):v.startVideoStreaming(function(){var t=0<arguments.length&&arguments[0]!==V?arguments[0]:{};t.options=r||{},y(t,i)},{lastCameraStream:n,callback:i,webcamVideoElement:o,crossOrigin:r.crossOrigin})}({lastCameraStream:n,callback:e,webcamVideoElement:a,options:i})}}var w={utils:o,error:s,defaultOptions:a,createGIF:x,takeSnapShot:function(t,e){if(e=M.isFunction(t)?t:e,t=M.isObject(t)?t:{},M.isFunction(e)){var i=M.mergeOptions(c,t);x(M.mergeOptions(i,{interval:.1,numFrames:1,gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),e)}},stopVideoStreaming:b,isSupported:function(){return d.isValid()},isWebCamGIFSupported:u,isExistingVideoGIFSupported:function(t){var i=!1;if(M.isArray(t)&&t.length){if(M.each(t,function(t,e){M.isSupported.videoCodecs[e]&&(i=!0)}),!i)return!1}else if(M.isString(t)&&t.length&&!M.isSupported.videoCodecs[t])return!1;return d.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return d.isValid({getUserMedia:!0})},VERSION:"0.4.5"};"function"==typeof V&&V.amd?V([],function(){return w}):C.exports=w}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})});function et(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var it=function(){function e(t){H(this,e),this.term=t,this.blobs=[],this.images=[],this.recording=!1,this.timer=null,this.frameRate=10}return a(e,[{key:"start",value:function(){k(!this.recording,"The recorder is recording...");var i=this.term.template.$canvas;this.recording=!0,this.term.emit("start"),function t(){var e=this;i.toBlob(function(t){e.blobs.push(t),e.images.push(URL.createObjectURL(t))}),this.term.emit("recording",{size:this.size,duration:this.duration}),this.timer=setTimeout(function(){e.term.isDestroy||t.call(e)},1e3/this.frameRate)}.call(this)}},{key:"end",value:function(){var e=this;this.recording=!1,clearTimeout(this.timer),this.term.emit("creating");var t=this.term,i=t.options.gifshotOpt,n=t.template.$container;tt.createGIF(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?et(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):et(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({gifWidth:n.clientWidth,gifHeight:n.clientHeight,numWorkers:4},i,{images:this.images}),function(t){t.err||(E(t.image,"".concat(Date.now(),".gif")),e.images.forEach(function(t){return URL.revokeObjectURL(t)}),e.blobs=[],e.images=[],e.term.emit("end"))})}},{key:"size",get:function(){return this.blobs.reduce(function(t,e){return t+e.size},0)}},{key:"duration",get:function(){return Math.floor(this.blobs.length/this.frameRate)}}]),e}(),nt=function(){function t(i){var n=this;H(this,t),this.term=i,this.color="#66d9ef",this.radioTip="(select: Up or Down, confirm: Enter)",this.checkboxTip="(move: Up or Down, select: Space, confirm: Enter)",this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null},this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null},this.radio=function(t){return n.render(t,Q)},this.checkbox=function(t){return n.render(t,D)},i.on("keydown",function(t){var e=i.drawer.lastCacheLog;e.style===Q&&n.radioList===e.list&&n.radioEvent(t),e.style===D&&n.checkboxList===e.list&&n.checkboxEvent(t)})}return a(t,[{key:"render",value:function(e,i){var n=this;return new Promise(function(t){f(e,[{key:"string|number",text:"string|number"}]),k(e.length,"".concat(i," array cannot be empty")),k(e.map(function(t){return t.key}).every(function(t,e,i){return i.indexOf(t)===i.lastIndexOf(t)}),"The key value in the array element must be unique"),i===Q&&(n.radioList=e,n.radioKey=e[0].key,n.radioResolve=t,n.radioRender(e,n.radioKey),n.radioInit=!0),i===D&&(n.checkboxList=e,n.checkboxIndex=0,n.checkboxKey=[],n.checkboxResolve=t,n.checkboxRender(),n.checkboxInit=!0)})}},{key:"radioRender",value:function(){var e=this,t=this.radioList.map(function(t){return e.radioKey===t.key?"<d color='".concat(e.color,"'>=> ").concat(t.text,"</d>"):"   ".concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.radioTip),list:this.radioList,type:S,style:Q,replace:this.radioInit})}},{key:"radioEvent",value:function(t){var e=this,i=t.keyCode,n=this.radioList.findIndex(function(t){return t.key===e.radioKey});38===i&&(t.preventDefault(),this.radioKey=n<=0?this.radioList[this.radioList.length-1].key:this.radioList[n-1].key,this.radioRender()),40===i&&(t.preventDefault(),n===this.radioList.length-1?this.radioKey=this.radioList[0].key:this.radioKey=this.radioList[n+1].key,this.radioRender()),13===i&&(this.radioResolve(this.radioKey),this.radioInit=!1,this.radioList=[],this.radioKey=null,this.radioResolve=function(){return null})}},{key:"checkboxRender",value:function(){var i=this,t=this.checkboxList.map(function(t,e){return e===i.checkboxIndex?"<d color='".concat(i.color,"'>").concat(i.checkboxKey.includes(t.key)?"":""," ").concat(t.text,"</d>"):"".concat(i.checkboxKey.includes(t.key)?"":""," ").concat(t.text)}).join("\n");this.term.drawer.emit({text:"".concat(t,"\n").concat(this.checkboxTip),list:this.checkboxList,type:S,style:D,replace:this.checkboxInit})}},{key:"checkboxEvent",value:function(t){var e=t.keyCode;if(38===e&&(t.preventDefault(),this.checkboxIndex<=0?this.checkboxIndex=this.checkboxList.length-1:--this.checkboxIndex,this.radioKey=this.checkboxList[this.checkboxIndex].key,this.checkboxRender()),40===e&&(t.preventDefault(),this.checkboxIndex===this.checkboxList.length-1?this.checkboxIndex=0:this.checkboxIndex+=1,this.checkboxRender()),32===e){var i=this.checkboxList[this.checkboxIndex].key,n=this.checkboxKey.indexOf(i);-1<n?this.checkboxKey.splice(n,1):this.checkboxKey.push(i),this.checkboxRender()}13===e&&(this.checkboxResolve(this.checkboxKey),this.checkboxInit=!1,this.checkboxList=[],this.checkboxIndex=0,this.checkboxKey=[],this.checkboxResolve=function(){return null})}}]),t}();function rt(t,e){var r="-",o="|",s=" ";return t.output(function i(t,e){var n=1<arguments.length&&void 0!==e?e:0;return t.map(function(t){var e=t.child&&t.child.length;return(n?o:"")+"".concat(s.repeat(n?4*n-1:0)).concat(o+r.repeat(2)," ").concat(t.value)+(e?"\n".concat(i(t.child,n+1)):"")}).join("\n")}(e))}function ot(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function st(n){return function(){var t,e=l(n);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=l(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return u(this,t)}}var at=0,ct=[];return function(){e(n,h);var i=st(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return H(this,n),(e=i.call(this)).options=f(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ot(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},n.default,{},t),n.scheme),e.isDestroy=!1,e.isFocus=!1,e.template=new R(r(e)),e.events=new B(r(e)),e.drawer=new Y(r(e)),e.commander=new q(r(e)),e.inquirer=new nt(r(e)),e.video=new K(r(e)),e.gif=new it(r(e)),e.ask=e.commander.ask,e.type=e.commander.type,e.input=e.commander.input,e.output=e.commander.output,e.clear=e.drawer.clear,e.radio=e.inquirer.radio,e.checkbox=e.inquirer.checkbox,e.tree=function(t){return rt(r(e),t)},at+=1,e.id=at,ct.push(r(e)),e}return a(n,null,[{key:"instances",get:function(){return ct}},{key:"version",get:function(){return"1.1.7"}},{key:"utils",get:function(){return A}},{key:"default",get:function(){return{container:"#term",width:600,height:500,actions:[],parseOpt:{},recorder:!0,recordType:"video",gifshotOpt:{},draggable:!0,dragOpt:{},fontSize:13,watermark:"",fontFamily:"monospace",fontColor:"#b0b2b6",title:"Term Web",prefix:'root@linux: ~ <d color="#00f501">$</d> ',welcome:"Last login: ".concat(new Date),loading:function(){return'<d color="yellow">Loading...</d>'},backgroundColor:"rgb(42, 39, 52)",pixelRatio:window.devicePixelRatio,notFound:function(t){return"-bash: <d color='red'>".concat(t,"</d>: command not found")}}}},{key:"scheme",get:function(){return{container:"string|htmldivelement",width:"number",height:"number",actions:[{input:"string|regexp",output:"string|function"}],parseOpt:"object",recorder:"boolean",recordType:"string",gifshotOpt:"object",draggable:"boolean",dragOpt:"object",fontSize:"number",watermark:"string",fontFamily:"string",fontColor:"string",title:"string",prefix:"string",welcome:"string",loading:"function",backgroundColor:"string",pixelRatio:"number",notFound:"function"}}}]),a(n,[{key:"destroy",value:function(){ct.splice(ct.indexOf(this),1),this.events.destroy(),this.template.destroy(),this.isDestroy=!0,this.emit("destroy")}},{key:"color",set:function(t){this.options.fontColor=t,this.drawer.init()}},{key:"background",set:function(t){this.options.backgroundColor=t,this.drawer.init()}},{key:"watermark",set:function(t){this.options.watermark=t,this.drawer.init()}},{key:"width",set:function(t){this.emit("resize",{width:t,height:this.template.$container.clientHeight})}},{key:"height",set:function(t){this.emit("resize",{width:this.template.$container.clientWidth,height:t})}}]),n}()});
